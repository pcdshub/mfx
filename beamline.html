
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="JTB">
      
      
      
        <link rel="prev" href="bash_utilities.html">
      
      
        <link rel="next" href="cctbx.html">
      
      
      <link rel="icon" href="media/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>Beamline - MFX Docs</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
        <script src="https://unpkg.com/iframe-worker/shim"></script>
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="orange" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mfx.beamline" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="MFX Docs" class="md-header__button md-logo" aria-label="MFX Docs" data-md-component="logo">
      
  <img src="media/logo_2.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MFX Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Beamline
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pcdshub/mfx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="MFX Docs" class="md-nav__button md-logo" aria-label="MFX Docs" data-md-component="logo">
      
  <img src="media/logo_2.png" alt="logo">

    </a>
    MFX Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pcdshub/mfx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Quick_Start.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Operating Procedures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Operating Procedures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="General.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DoT.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DoT
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Source
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Source
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    MFX
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            MFX
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="attenuator_scan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attenuator scan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="autorun.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autorun
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="bash_utilities.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bash utilities
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Beamline
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="beamline.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Beamline
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline" class="md-nav__link">
    <span class="md-ellipsis">
      beamline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI" class="md-nav__link">
    <span class="md-ellipsis">
      CoDI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoDI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.get_CoDI_pos" class="md-nav__link">
    <span class="md-ellipsis">
      get_CoDI_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_base_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_base_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_base_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_base_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_left_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_left_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_left_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_left_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_right_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_right_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_right_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_right_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_z_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_z_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_z_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_z_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.remove_CoDI_pos" class="md-nav__link">
    <span class="md-ellipsis">
      remove_CoDI_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_current_pos" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_current_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_current_z" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_current_z
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_pos" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_predefined" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_predefined
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.update_CoDI_predefined" class="md-nav__link">
    <span class="md-ellipsis">
      update_CoDI_predefined
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.Debug" class="md-nav__link">
    <span class="md-ellipsis">
      Debug
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Debug">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.awr" class="md-nav__link">
    <span class="md-ellipsis">
      awr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="awr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.awr--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_all_servers" class="md-nav__link">
    <span class="md-ellipsis">
      check_all_servers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_all_servers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_all_servers--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_server" class="md-nav__link">
    <span class="md-ellipsis">
      check_server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_server--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.cycle_server" class="md-nav__link">
    <span class="md-ellipsis">
      cycle_server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cycle_server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.cycle_server--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.server_list" class="md-nav__link">
    <span class="md-ellipsis">
      server_list
    </span>
  </a>
  
    <nav class="md-nav" aria-label="server_list">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.server_list--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.DoD" class="md-nav__link">
    <span class="md-ellipsis">
      DoD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DoD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.busy_wait" class="md-nav__link">
    <span class="md-ellipsis">
      busy_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.clear_abort" class="md-nav__link">
    <span class="md-ellipsis">
      clear_abort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.do_move" class="md-nav__link">
    <span class="md-ellipsis">
      do_move
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.do_task" class="md-nav__link">
    <span class="md-ellipsis">
      do_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position" class="md-nav__link">
    <span class="md-ellipsis">
      get_current_position
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_current_position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--expected_keys" class="md-nav__link">
    <span class="md-ellipsis">
      expected_keys = [
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--currentposition" class="md-nav__link">
    <span class="md-ellipsis">
      'CurrentPosition',
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--position" class="md-nav__link">
    <span class="md-ellipsis">
      'Position',
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--positionreal" class="md-nav__link">
    <span class="md-ellipsis">
      'PositionReal',
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--_1" class="md-nav__link">
    <span class="md-ellipsis">
      ]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_forbidden_region" class="md-nav__link">
    <span class="md-ellipsis">
      get_forbidden_region
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_nozzle_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_nozzle_status
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_nozzle_status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_nozzle_status--expected_keys" class="md-nav__link">
    <span class="md-ellipsis">
      expected_keys = [
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_task_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_task_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_task_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_task_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.logging_string" class="md-nav__link">
    <span class="md-ellipsis">
      logging_string
    </span>
  </a>
  
    <nav class="md-nav" aria-label="logging_string">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.logging_string--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.move_x_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_x_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.move_y_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_y_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.move_z_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_z_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_forbidden_region" class="md-nav__link">
    <span class="md-ellipsis">
      set_forbidden_region
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_nozzle_dispensing" class="md-nav__link">
    <span class="md-ellipsis">
      set_nozzle_dispensing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_abs_Xray" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_abs_Xray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_rel_LED" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_rel_LED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_rel_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_rel_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_relative_nozzle" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_relative_nozzle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_update" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_zero_nozzle" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_zero_nozzle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.stop_task" class="md-nav__link">
    <span class="md-ellipsis">
      stop_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.test_forbidden_region" class="md-nav__link">
    <span class="md-ellipsis">
      test_forbidden_region
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing" class="md-nav__link">
    <span class="md-ellipsis">
      MFX_Timing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MFX_Timing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing.set_seq" class="md-nav__link">
    <span class="md-ellipsis">
      set_seq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_seq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing.set_seq--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing.set_seq--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.OM" class="md-nav__link">
    <span class="md-ellipsis">
      OM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.check_settings" class="md-nav__link">
    <span class="md-ellipsis">
      check_settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.check_settings--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.check_settings--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.fix_run_om" class="md-nav__link">
    <span class="md-ellipsis">
      fix_run_om
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.fix_yaml" class="md-nav__link">
    <span class="md-ellipsis">
      fix_yaml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.gui" class="md-nav__link">
    <span class="md-ellipsis">
      gui
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.om" class="md-nav__link">
    <span class="md-ellipsis">
      om
    </span>
  </a>
  
    <nav class="md-nav" aria-label="om">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.om--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.om--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.reset--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.reset--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_separate_runs" class="md-nav__link">
    <span class="md-ellipsis">
      attenuator_scan_separate_runs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="attenuator_scan_separate_runs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_separate_runs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_separate_runs--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_single_run" class="md-nav__link">
    <span class="md-ellipsis">
      attenuator_scan_single_run
    </span>
  </a>
  
    <nav class="md-nav" aria-label="attenuator_scan_single_run">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_single_run--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_single_run--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.autorun" class="md-nav__link">
    <span class="md-ellipsis">
      autorun
    </span>
  </a>
  
    <nav class="md-nav" aria-label="autorun">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.autorun--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.autorun--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.begin" class="md-nav__link">
    <span class="md-ellipsis">
      begin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="begin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.begin--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.correct_timing_drift" class="md-nav__link">
    <span class="md-ellipsis">
      correct_timing_drift
    </span>
  </a>
  
    <nav class="md-nav" aria-label="correct_timing_drift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.correct_timing_drift--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.delay_scan" class="md-nav__link">
    <span class="md-ellipsis">
      delay_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delay_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.delay_scan--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image" class="md-nav__link">
    <span class="md-ellipsis">
      detector_image
    </span>
  </a>
  
    <nav class="md-nav" aria-label="detector_image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image_kill" class="md-nav__link">
    <span class="md-ellipsis">
      detector_image_kill
    </span>
  </a>
  
    <nav class="md-nav" aria-label="detector_image_kill">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image_kill--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image_kill--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.focus_scan" class="md-nav__link">
    <span class="md-ellipsis">
      focus_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="focus_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.focus_scan--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.focus_scan--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.infinite_scan" class="md-nav__link">
    <span class="md-ellipsis">
      infinite_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="infinite_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.infinite_scan--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.ioc_cam_recorder" class="md-nav__link">
    <span class="md-ellipsis">
      ioc_cam_recorder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ioc_cam_recorder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.ioc_cam_recorder--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.ioc_cam_recorder--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.laser_in" class="md-nav__link">
    <span class="md-ellipsis">
      laser_in
    </span>
  </a>
  
    <nav class="md-nav" aria-label="laser_in">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_in--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_in--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.laser_out" class="md-nav__link">
    <span class="md-ellipsis">
      laser_out
    </span>
  </a>
  
    <nav class="md-nav" aria-label="laser_out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_out--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_out--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.mfxslits" class="md-nav__link">
    <span class="md-ellipsis">
      mfxslits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.post" class="md-nav__link">
    <span class="md-ellipsis">
      post
    </span>
  </a>
  
    <nav class="md-nav" aria-label="post">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.post--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.xlj_fast_xyz" class="md-nav__link">
    <span class="md-ellipsis">
      xlj_fast_xyz
    </span>
  </a>
  
    <nav class="md-nav" aria-label="xlj_fast_xyz">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.xlj_fast_xyz--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.xlj_fast_xyz--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cctbx.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cctbx
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="debug.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Debug
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="delay_scan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Delay scan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="detector_image.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Detector image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="devices.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Devices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="focus_scan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Focus scan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="macros.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Macros
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mfx_timing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mfx timing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="rayonix.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rayonix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="suspenders.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suspenders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="timetool.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Timetool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="xlj_fast.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Xlj fast
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="yano.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Yano
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    DoD
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            DoD
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="DropsDriver.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DropsDriver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="HTTPTransceiver.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTPTransceiver
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="JsonFileHandler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JsonFileHandler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="ServerResponse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ServerResponse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="SupporEndsHandler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SupporEndsHandler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TestJsonFileHandler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestJsonFileHandler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TestResponse.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TestResponse
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="codi.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Codi
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="common.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dod.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dod
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mfxDOD_old.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mfxDOD old
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="mfx_dod_old.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mfx dod old
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="testServer.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testServer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="testServerSpawner.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    testServerSpawner
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    TFS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            TFS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="lens.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lens
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="offline_calculator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Offline calculator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="transfocator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfocator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="transfocator_scan.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfocator scan
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="utils.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    scripts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            scripts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_4_1" id="__nav_4_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    auto_idle
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_1">
            <span class="md-nav__icon md-icon"></span>
            auto_idle
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="idler.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Idler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_4_2" id="__nav_4_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    cctbx
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_2">
            <span class="md-nav__icon md-icon"></span>
            cctbx
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cctbx_start.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cctbx start
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_4_3" id="__nav_4_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    door_watcher
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_3">
            <span class="md-nav__icon md-icon"></span>
            door_watcher
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="door_watcher.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Door watcher
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline" class="md-nav__link">
    <span class="md-ellipsis">
      beamline
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI" class="md-nav__link">
    <span class="md-ellipsis">
      CoDI
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoDI">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.get_CoDI_pos" class="md-nav__link">
    <span class="md-ellipsis">
      get_CoDI_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_base_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_base_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_base_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_base_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_left_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_left_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_left_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_left_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_right_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_right_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_rot_right_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_rot_right_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_z_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_z_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.move_z_rel" class="md-nav__link">
    <span class="md-ellipsis">
      move_z_rel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.remove_CoDI_pos" class="md-nav__link">
    <span class="md-ellipsis">
      remove_CoDI_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_current_pos" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_current_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_current_z" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_current_z
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_pos" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_pos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.set_CoDI_predefined" class="md-nav__link">
    <span class="md-ellipsis">
      set_CoDI_predefined
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.CoDI.update_CoDI_predefined" class="md-nav__link">
    <span class="md-ellipsis">
      update_CoDI_predefined
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.Debug" class="md-nav__link">
    <span class="md-ellipsis">
      Debug
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Debug">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.awr" class="md-nav__link">
    <span class="md-ellipsis">
      awr
    </span>
  </a>
  
    <nav class="md-nav" aria-label="awr">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.awr--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_all_servers" class="md-nav__link">
    <span class="md-ellipsis">
      check_all_servers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_all_servers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_all_servers--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_server" class="md-nav__link">
    <span class="md-ellipsis">
      check_server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.check_server--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.cycle_server" class="md-nav__link">
    <span class="md-ellipsis">
      cycle_server
    </span>
  </a>
  
    <nav class="md-nav" aria-label="cycle_server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.cycle_server--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.server_list" class="md-nav__link">
    <span class="md-ellipsis">
      server_list
    </span>
  </a>
  
    <nav class="md-nav" aria-label="server_list">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.Debug.server_list--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.DoD" class="md-nav__link">
    <span class="md-ellipsis">
      DoD
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DoD">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.busy_wait" class="md-nav__link">
    <span class="md-ellipsis">
      busy_wait
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.clear_abort" class="md-nav__link">
    <span class="md-ellipsis">
      clear_abort
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.do_move" class="md-nav__link">
    <span class="md-ellipsis">
      do_move
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.do_task" class="md-nav__link">
    <span class="md-ellipsis">
      do_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position" class="md-nav__link">
    <span class="md-ellipsis">
      get_current_position
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_current_position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--expected_keys" class="md-nav__link">
    <span class="md-ellipsis">
      expected_keys = [
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--currentposition" class="md-nav__link">
    <span class="md-ellipsis">
      'CurrentPosition',
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--position" class="md-nav__link">
    <span class="md-ellipsis">
      'Position',
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--positionreal" class="md-nav__link">
    <span class="md-ellipsis">
      'PositionReal',
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_current_position--_1" class="md-nav__link">
    <span class="md-ellipsis">
      ]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_forbidden_region" class="md-nav__link">
    <span class="md-ellipsis">
      get_forbidden_region
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_nozzle_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_nozzle_status
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_nozzle_status">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_nozzle_status--expected_keys" class="md-nav__link">
    <span class="md-ellipsis">
      expected_keys = [
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_status" class="md-nav__link">
    <span class="md-ellipsis">
      get_status
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_task_details" class="md-nav__link">
    <span class="md-ellipsis">
      get_task_details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.get_task_names" class="md-nav__link">
    <span class="md-ellipsis">
      get_task_names
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.logging_string" class="md-nav__link">
    <span class="md-ellipsis">
      logging_string
    </span>
  </a>
  
    <nav class="md-nav" aria-label="logging_string">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.logging_string--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.move_x_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_x_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.move_y_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_y_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.move_z_abs" class="md-nav__link">
    <span class="md-ellipsis">
      move_z_abs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_forbidden_region" class="md-nav__link">
    <span class="md-ellipsis">
      set_forbidden_region
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_nozzle_dispensing" class="md-nav__link">
    <span class="md-ellipsis">
      set_nozzle_dispensing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_abs_Xray" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_abs_Xray
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_rel_LED" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_rel_LED
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_rel_reaction" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_rel_reaction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_relative_nozzle" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_relative_nozzle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_update" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_update
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.set_timing_zero_nozzle" class="md-nav__link">
    <span class="md-ellipsis">
      set_timing_zero_nozzle
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.stop_task" class="md-nav__link">
    <span class="md-ellipsis">
      stop_task
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.DoD.test_forbidden_region" class="md-nav__link">
    <span class="md-ellipsis">
      test_forbidden_region
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing" class="md-nav__link">
    <span class="md-ellipsis">
      MFX_Timing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MFX_Timing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing.set_seq" class="md-nav__link">
    <span class="md-ellipsis">
      set_seq
    </span>
  </a>
  
    <nav class="md-nav" aria-label="set_seq">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing.set_seq--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.MFX_Timing.set_seq--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.OM" class="md-nav__link">
    <span class="md-ellipsis">
      OM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="OM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.check_settings" class="md-nav__link">
    <span class="md-ellipsis">
      check_settings
    </span>
  </a>
  
    <nav class="md-nav" aria-label="check_settings">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.check_settings--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.check_settings--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.fix_run_om" class="md-nav__link">
    <span class="md-ellipsis">
      fix_run_om
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.fix_yaml" class="md-nav__link">
    <span class="md-ellipsis">
      fix_yaml
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.gui" class="md-nav__link">
    <span class="md-ellipsis">
      gui
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.om" class="md-nav__link">
    <span class="md-ellipsis">
      om
    </span>
  </a>
  
    <nav class="md-nav" aria-label="om">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.om--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.om--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="reset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.reset--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.OM.reset--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_separate_runs" class="md-nav__link">
    <span class="md-ellipsis">
      attenuator_scan_separate_runs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="attenuator_scan_separate_runs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_separate_runs--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_separate_runs--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_single_run" class="md-nav__link">
    <span class="md-ellipsis">
      attenuator_scan_single_run
    </span>
  </a>
  
    <nav class="md-nav" aria-label="attenuator_scan_single_run">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_single_run--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.attenuator_scan_single_run--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.autorun" class="md-nav__link">
    <span class="md-ellipsis">
      autorun
    </span>
  </a>
  
    <nav class="md-nav" aria-label="autorun">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.autorun--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.autorun--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.begin" class="md-nav__link">
    <span class="md-ellipsis">
      begin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="begin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.begin--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.correct_timing_drift" class="md-nav__link">
    <span class="md-ellipsis">
      correct_timing_drift
    </span>
  </a>
  
    <nav class="md-nav" aria-label="correct_timing_drift">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.correct_timing_drift--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.delay_scan" class="md-nav__link">
    <span class="md-ellipsis">
      delay_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="delay_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.delay_scan--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image" class="md-nav__link">
    <span class="md-ellipsis">
      detector_image
    </span>
  </a>
  
    <nav class="md-nav" aria-label="detector_image">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image_kill" class="md-nav__link">
    <span class="md-ellipsis">
      detector_image_kill
    </span>
  </a>
  
    <nav class="md-nav" aria-label="detector_image_kill">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image_kill--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.detector_image_kill--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.focus_scan" class="md-nav__link">
    <span class="md-ellipsis">
      focus_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="focus_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.focus_scan--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.focus_scan--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.infinite_scan" class="md-nav__link">
    <span class="md-ellipsis">
      infinite_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="infinite_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.infinite_scan--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.ioc_cam_recorder" class="md-nav__link">
    <span class="md-ellipsis">
      ioc_cam_recorder
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ioc_cam_recorder">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.ioc_cam_recorder--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.ioc_cam_recorder--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.laser_in" class="md-nav__link">
    <span class="md-ellipsis">
      laser_in
    </span>
  </a>
  
    <nav class="md-nav" aria-label="laser_in">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_in--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_in--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.laser_out" class="md-nav__link">
    <span class="md-ellipsis">
      laser_out
    </span>
  </a>
  
    <nav class="md-nav" aria-label="laser_out">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_out--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.laser_out--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.mfxslits" class="md-nav__link">
    <span class="md-ellipsis">
      mfxslits
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.post" class="md-nav__link">
    <span class="md-ellipsis">
      post
    </span>
  </a>
  
    <nav class="md-nav" aria-label="post">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.post--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mfx.beamline.xlj_fast_xyz" class="md-nav__link">
    <span class="md-ellipsis">
      xlj_fast_xyz
    </span>
  </a>
  
    <nav class="md-nav" aria-label="xlj_fast_xyz">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.xlj_fast_xyz--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mfx.beamline.xlj_fast_xyz--operations" class="md-nav__link">
    <span class="md-ellipsis">
      Operations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Beamline</h1>

<div class="doc doc-object doc-module">



<a id="mfx.beamline"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="mfx.beamline.CoDI" class="doc doc-heading">
            <code>CoDI</code>


</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>dod/codi.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CoDI</span><span class="p">:</span> 
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reload_presets</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class definition of the DoD codi injector </span>
<span class="sd">        Parameters</span>
<span class="sd">        reload_presets : Boolean</span>
<span class="sd">            force resetting the presets (overwriting existing hutch presets)</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectComponent</span> <span class="k">as</span> <span class="n">OCpt</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.epics_motor</span><span class="w"> </span><span class="kn">import</span> <span class="n">SmarAct</span><span class="p">,</span> <span class="n">Motor</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="c1"># CoDI motor PVs loading </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m3&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_rot_left&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m1&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_rot_right&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m2&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_rot_base&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m4&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_trans_z&#39;</span><span class="p">)</span>

        <span class="c1">#Predefined positions CoDI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">reload_presets</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="c1"># self.CoDI_pos_predefined[&#39;aspiration&#39;] = (0.0,0.0,0.0,0.0) </span>
            <span class="c1"># self.CoDI_pos_predefined[&#39;angled_vert&#39;] = (0.0,45.0,45.0,0.0)</span>
            <span class="c1"># self.CoDI_pos_predefined[&#39;angled_hor&#39;] = (90.0,45.0,45.0,0.0)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="s1">&#39;aspiration&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="s1">&#39;angled_vert&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="s1">&#39;angled_hor&#39;</span><span class="p">,</span><span class="mf">90.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">all_presets</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="c1">#Needs to be fixed</span>
            <span class="k">for</span> <span class="n">preset</span><span class="p">,</span> <span class="n">preset_value</span> <span class="ow">in</span> <span class="n">all_presets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
                <span class="k">try</span><span class="p">:</span> 
                    <span class="c1"># get preset position</span>
                    <span class="n">exec_base</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_base = self.CoDI_rot_base.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                    <span class="n">exec_rot_left</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_left = self.CoDI_rot_left.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                    <span class="n">exec_rot_right</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_right = self.CoDI_rot_right.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                    <span class="n">exec_trans_z</span> <span class="o">=</span> <span class="s2">&quot;preset_trans_z = self.CoDI_trans_z.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                    <span class="n">exec</span><span class="p">(</span><span class="n">exec_base</span><span class="p">)</span>
                    <span class="n">exec</span><span class="p">(</span><span class="n">exec_rot_left</span><span class="p">)</span>
                    <span class="n">exec</span><span class="p">(</span><span class="n">exec_rot_right</span><span class="p">)</span>
                    <span class="n">exec</span><span class="p">(</span><span class="n">exec_trans_z</span><span class="p">)</span>

                    <span class="c1"># Save to local database</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">preset_rot_base</span><span class="p">,</span> <span class="n">preset_rot_left</span><span class="p">,</span> <span class="n">preset_rot_right</span><span class="p">,</span> <span class="n">preset_trans_z</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span> 
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;skipping preset &#39;</span><span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;, as it is not defined in all motors&#39;</span><span class="p">)</span>    


        <span class="c1"># # create config parser handler</span>
        <span class="c1"># json_handler = JsonFileHandler(supported_json)</span>
        <span class="c1"># # load configs and launch web server</span>
        <span class="c1"># json_handler.reload_endpoints()</span>

        <span class="c1"># Flag that can be used later on for safety aborts during task execution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_CoDI_predefined</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>


        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">update_CoDI_predefined</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
        <span class="s1">&#39;reloads all the hutch python presets for motors and overwrites local position preset dict&#39;</span>

        <span class="c1">#Predefined positions CoDI</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="n">all_presets</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="c1">#Needs to be fixed</span>
        <span class="k">for</span> <span class="n">preset</span> <span class="ow">in</span> <span class="n">all_presets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
            <span class="c1"># try: </span>
            <span class="c1"># get preset position</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exec_base</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_base = self.CoDI_rot_base.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_left = self.CoDI_rot_left.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_right</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_right = self.CoDI_rot_right.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">exec_trans_z</span> <span class="o">=</span> <span class="s2">&quot;preset_trans_z = self.CoDI_trans_z.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_base</span><span class="p">)</span>
            <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_base</span><span class="p">)</span>

            <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span><span class="p">)</span>

            <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_right</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span><span class="p">)</span>

            <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_trans_z</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_trans_z</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">preset_trans_z</span><span class="p">)</span>

            <span class="c1"># Save to local database</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">preset_rot_base</span><span class="p">,</span> <span class="n">preset_rot_left</span><span class="p">,</span> <span class="n">preset_rot_right</span><span class="p">,</span> <span class="n">preset_trans_z</span><span class="p">)</span>
            <span class="c1"># except: </span>
            <span class="c1">#     print(&#39;skipping preset &#39;+ preset + &#39;, as it is not defined in all motors&#39;)    </span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_predefined</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        defines or updates a predefined combination for CoDI</span>

<span class="sd">        Parameters</span>
<span class="sd">        name : str</span>
<span class="sd">            name of the pre-definition</span>
<span class="sd">        base : float</span>
<span class="sd">            rotation of base</span>
<span class="sd">        left : float</span>
<span class="sd">            rotation of left injector</span>
<span class="sd">        right : float</span>
<span class="sd">            rotation of right injector</span>
<span class="sd">        z : float</span>
<span class="sd">            translation of right injector</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">z</span><span class="p">)})</span>

        <span class="c1"># Presets using MFX presets functionalities </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">left</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">right</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">base</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">z</span><span class="p">)</span>



    <span class="k">def</span><span class="w"> </span><span class="nf">get_CoDI_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision_digits</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets the colliding droplet injector motor positions as tuple</span>

<span class="sd">        Parameters</span>
<span class="sd">        precision_digits : int</span>
<span class="sd">            precision with which the pre-defined positions are checked </span>

<span class="sd">        ----------</span>
<span class="sd">        Return : (tuple, 5)</span>
<span class="sd">            motor positions of the CoDI motors. (name of preset, rot_base, rot_left, rot_right, trans_z)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos_rot_base</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>
        <span class="n">pos_rot_left</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>
        <span class="n">pos_rot_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>
        <span class="n">pos_trans_z</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

        <span class="c1"># # for testing purposes</span>
        <span class="c1"># pos_rot_base  = 0</span>
        <span class="c1"># pos_rot_left  = 45</span>
        <span class="c1"># pos_rot_right = 45</span>
        <span class="c1"># pos_trans_z   = 0</span>

        <span class="n">pos_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_rot_base</span><span class="p">,</span><span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span><span class="n">pos_trans_z</span><span class="p">)</span>

        <span class="n">pos_rounded</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">each_pos</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">each_pos</span> <span class="ow">in</span> <span class="n">pos_tuple</span><span class="p">])</span>

        <span class="c1"># Test if this is one of the preset positions: </span>
        <span class="n">pos_name</span> <span class="o">=</span> <span class="s1">&#39;undefined&#39;</span>
        <span class="k">for</span> <span class="n">preset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">:</span>
            <span class="n">preset_rounded</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">each_pos</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">each_pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">preset</span><span class="p">]])</span>
            <span class="k">if</span> <span class="n">preset_rounded</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">pos_rounded</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
                <span class="n">pos_name</span> <span class="o">=</span> <span class="n">preset</span>

        <span class="k">return</span> <span class="n">pos_name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos_name</span><span class="p">,</span> <span class="n">wait</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Moves the colliding droplet injector into a pre-defined position. </span>

<span class="sd">        Parameters</span>
<span class="sd">        pos_name : string</span>
<span class="sd">            name of the pre-defined position</span>
<span class="sd">        wait : boolean</span>
<span class="sd">            if the robot waits before continuing further steps</span>

<span class="sd">        ----------</span>
<span class="sd">        Return : </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># pos_rot_base  = CoDI_base.wm()</span>
        <span class="c1"># pos_rot_left  = CoDI_left.wm()</span>
        <span class="c1"># pos_rot_right = CoDI_right.wm()</span>
        <span class="c1"># pos_trans_z   = CoDI_z.wm()</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="c1"># get target positions</span>
        <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">pos_name</span><span class="p">]</span>

        <span class="c1"># Move motors</span>

        <span class="c1"># Old wayy </span>
        <span class="c1"># self.CoDI_rot_base.mv(pos_rot_base, wait=False)</span>
        <span class="c1"># self.CoDI_rot_left.mv(pos_rot_left,  wait=False)</span>
        <span class="c1"># self.CoDI_rot_right.mv(pos_rot_right, wait=False)</span>
        <span class="c1"># self.CoDI_trans_z.mv(pos_trans_z, wait=False)</span>

        <span class="c1"># Move using hutch python presets</span>
        <span class="n">exec_base</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_rot_base.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">exec_base</span><span class="p">)</span>
        <span class="n">exec_left</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_rot_left.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">exec_left</span><span class="p">)</span>
        <span class="n">exec_right</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_rot_right.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">exec_right</span><span class="p">)</span>
        <span class="n">exec_z</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_trans_z.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
        <span class="n">exec</span><span class="p">(</span><span class="n">exec_z</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wait</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="n">test_name</span><span class="p">,</span> <span class="n">test_pos_rot_base</span><span class="p">,</span> <span class="n">test_pos_rot_left</span><span class="p">,</span> <span class="n">test_pos_rot_right</span><span class="p">,</span> <span class="n">test_pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">pos_name</span> <span class="o">!=</span> <span class="n">test_name</span><span class="p">:</span> 
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1"> waiting for motion to end: </span><span class="si">%i</span><span class="s1"> s&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
                <span class="n">test_name</span><span class="p">,</span> <span class="n">test_pos_rot_base</span><span class="p">,</span> <span class="n">test_pos_rot_left</span><span class="p">,</span> <span class="n">test_pos_rot_right</span><span class="p">,</span> <span class="n">test_pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Motion ended&#39;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_current_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        defines or updates the current motor combination for CoDI</span>

<span class="sd">        Parameters</span>
<span class="sd">        name : str</span>
<span class="sd">            name of the pre-definition</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pos_name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_current_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        sets the current z position to all preloaded positions</span>
<span class="sd">        Useful for global change of z after aligning</span>

<span class="sd">        Parameters</span>
<span class="sd">        verbose : Boolean</span>
<span class="sd">            prints the new positions as a sanity check if True</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get current z position:</span>
        <span class="n">pos_trans_z_new</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

        <span class="c1"># get all keys from the positions</span>
        <span class="n">position_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="o">.</span><span class="n">keys</span>

        <span class="c1">#go through all positions and change the z-value to the current z value</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">position_keys</span><span class="p">:</span> 
            <span class="n">pos_name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">pos_name</span><span class="p">,</span><span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z_new</span><span class="p">)</span>

        <span class="c1">#Print the new predefined positions as a sanity check</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_predefined</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">remove_CoDI_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        removes the defined motor combination for CoDI from local database</span>

<span class="sd">        Parameters</span>
<span class="sd">        name : str</span>
<span class="sd">            name of the pre-definition to be deleted</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_z_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_rel</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the z position relative to the current position </span>

<span class="sd">        Parameters</span>
<span class="sd">        z_rel : float</span>
<span class="sd">            relative motion in mm</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get current z position:</span>
        <span class="n">pos_trans_z</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

        <span class="c1"># set new position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">z_rel</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">move_rot_left_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_rel</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the rotation of the left nozzle relative to the current position in degree</span>

<span class="sd">        Parameters</span>
<span class="sd">        rot_rel : float</span>
<span class="sd">            relative motion in degree</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get current position:</span>
        <span class="n">pos_rot_left</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

        <span class="c1"># set new position: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_rot_right_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_rel</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the rotation of the right nozzle relative to the current position in degree</span>

<span class="sd">        Parameters</span>
<span class="sd">        rot_rel : float</span>
<span class="sd">            relative motion in degree</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get current position:</span>
        <span class="n">pos_rot_right</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

        <span class="c1"># set new position: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_rot_base_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_rel</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the rotation of the base relative to the current position in degree</span>

<span class="sd">        Parameters</span>
<span class="sd">        rot_rel : float</span>
<span class="sd">            relative motion in degree</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># get current position:</span>
        <span class="n">pos_rot_base</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

        <span class="c1"># set new position: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_z_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_abs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the z position to the absolute position in mm</span>

<span class="sd">        Parameters</span>
<span class="sd">        z_abs : float</span>
<span class="sd">            absolute motion in mm</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># move z position:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">z_abs</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_rot_left_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_abs</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            moves the rotation of the left nozzle to the absolute position in degree</span>

<span class="sd">            Parameters</span>
<span class="sd">            rot_abs : float</span>
<span class="sd">                abs motion in degree</span>
<span class="sd">            ----------</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># set new position: </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_rot_right_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_abs</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            moves the rotation of the right nozzle to the absolute position in degree</span>

<span class="sd">            Parameters</span>
<span class="sd">            rot_abs : float</span>
<span class="sd">                abs motion in degree</span>
<span class="sd">            ----------</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># set new position: </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_rot_base_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_abs</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            moves the rotation of the base to the absolute position in degree</span>

<span class="sd">            Parameters</span>
<span class="sd">            rot_abs : float</span>
<span class="sd">                abs motion in degree</span>
<span class="sd">            ----------</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="c1"># set new position: </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">reload_presets</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Class definition of the DoD codi injector 
Parameters
reload_presets : Boolean
    force resetting the presets (overwriting existing hutch presets)</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reload_presets</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class definition of the DoD codi injector </span>
<span class="sd">    Parameters</span>
<span class="sd">    reload_presets : Boolean</span>
<span class="sd">        force resetting the presets (overwriting existing hutch presets)</span>
<span class="sd">    ----------</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.device</span><span class="w"> </span><span class="kn">import</span> <span class="n">ObjectComponent</span> <span class="k">as</span> <span class="n">OCpt</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.epics_motor</span><span class="w"> </span><span class="kn">import</span> <span class="n">SmarAct</span><span class="p">,</span> <span class="n">Motor</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="c1"># CoDI motor PVs loading </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m3&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_rot_left&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m1&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_rot_right&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m2&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_rot_base&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span> <span class="o">=</span> <span class="n">SmarAct</span><span class="p">(</span><span class="s1">&#39;MFX:MCS2:01:m4&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;CoDI_trans_z&#39;</span><span class="p">)</span>

    <span class="c1">#Predefined positions CoDI</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">reload_presets</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="c1"># self.CoDI_pos_predefined[&#39;aspiration&#39;] = (0.0,0.0,0.0,0.0) </span>
        <span class="c1"># self.CoDI_pos_predefined[&#39;angled_vert&#39;] = (0.0,45.0,45.0,0.0)</span>
        <span class="c1"># self.CoDI_pos_predefined[&#39;angled_hor&#39;] = (90.0,45.0,45.0,0.0)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="s1">&#39;aspiration&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="s1">&#39;angled_vert&#39;</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="s1">&#39;angled_hor&#39;</span><span class="p">,</span><span class="mf">90.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">45.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">all_presets</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="c1">#Needs to be fixed</span>
        <span class="k">for</span> <span class="n">preset</span><span class="p">,</span> <span class="n">preset_value</span> <span class="ow">in</span> <span class="n">all_presets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> 
            <span class="k">try</span><span class="p">:</span> 
                <span class="c1"># get preset position</span>
                <span class="n">exec_base</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_base = self.CoDI_rot_base.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                <span class="n">exec_rot_left</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_left = self.CoDI_rot_left.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                <span class="n">exec_rot_right</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_right = self.CoDI_rot_right.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                <span class="n">exec_trans_z</span> <span class="o">=</span> <span class="s2">&quot;preset_trans_z = self.CoDI_trans_z.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">exec_base</span><span class="p">)</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">exec_rot_left</span><span class="p">)</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">exec_rot_right</span><span class="p">)</span>
                <span class="n">exec</span><span class="p">(</span><span class="n">exec_trans_z</span><span class="p">)</span>

                <span class="c1"># Save to local database</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">preset_rot_base</span><span class="p">,</span> <span class="n">preset_rot_left</span><span class="p">,</span> <span class="n">preset_rot_right</span><span class="p">,</span> <span class="n">preset_trans_z</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;skipping preset &#39;</span><span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;, as it is not defined in all motors&#39;</span><span class="p">)</span>    


    <span class="c1"># # create config parser handler</span>
    <span class="c1"># json_handler = JsonFileHandler(supported_json)</span>
    <span class="c1"># # load configs and launch web server</span>
    <span class="c1"># json_handler.reload_endpoints()</span>

    <span class="c1"># Flag that can be used later on for safety aborts during task execution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.get_CoDI_pos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_CoDI_pos</span><span class="p">(</span><span class="n">precision_digits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>gets the colliding droplet injector motor positions as tuple</p>
<p>Parameters
precision_digits : int
    precision with which the pre-defined positions are checked </p>
<hr />
<p>Return : (tuple, 5)
    motor positions of the CoDI motors. (name of preset, rot_base, rot_left, rot_right, trans_z)</p>

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_CoDI_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">precision_digits</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    gets the colliding droplet injector motor positions as tuple</span>

<span class="sd">    Parameters</span>
<span class="sd">    precision_digits : int</span>
<span class="sd">        precision with which the pre-defined positions are checked </span>

<span class="sd">    ----------</span>
<span class="sd">    Return : (tuple, 5)</span>
<span class="sd">        motor positions of the CoDI motors. (name of preset, rot_base, rot_left, rot_right, trans_z)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pos_rot_base</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>
    <span class="n">pos_rot_left</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>
    <span class="n">pos_rot_right</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>
    <span class="n">pos_trans_z</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

    <span class="c1"># # for testing purposes</span>
    <span class="c1"># pos_rot_base  = 0</span>
    <span class="c1"># pos_rot_left  = 45</span>
    <span class="c1"># pos_rot_right = 45</span>
    <span class="c1"># pos_trans_z   = 0</span>

    <span class="n">pos_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="n">pos_rot_base</span><span class="p">,</span><span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span><span class="n">pos_trans_z</span><span class="p">)</span>

    <span class="n">pos_rounded</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">each_pos</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">each_pos</span> <span class="ow">in</span> <span class="n">pos_tuple</span><span class="p">])</span>

    <span class="c1"># Test if this is one of the preset positions: </span>
    <span class="n">pos_name</span> <span class="o">=</span> <span class="s1">&#39;undefined&#39;</span>
    <span class="k">for</span> <span class="n">preset</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">:</span>
        <span class="n">preset_rounded</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">each_pos</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> <span class="k">for</span> <span class="n">each_pos</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">preset</span><span class="p">]])</span>
        <span class="k">if</span> <span class="n">preset_rounded</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">pos_rounded</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> 
            <span class="n">pos_name</span> <span class="o">=</span> <span class="n">preset</span>

    <span class="k">return</span> <span class="n">pos_name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_rot_base_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_rot_base_abs</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the rotation of the base to the absolute position in degree</p>
<p>Parameters
rot_abs : float
    abs motion in degree</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_rot_base_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_abs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the rotation of the base to the absolute position in degree</span>

<span class="sd">        Parameters</span>
<span class="sd">        rot_abs : float</span>
<span class="sd">            abs motion in degree</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set new position: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_rot_base_rel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_rot_base_rel</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the rotation of the base relative to the current position in degree</p>
<p>Parameters
rot_rel : float
    relative motion in degree</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_rot_base_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_rel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    moves the rotation of the base relative to the current position in degree</span>

<span class="sd">    Parameters</span>
<span class="sd">    rot_rel : float</span>
<span class="sd">        relative motion in degree</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get current position:</span>
    <span class="n">pos_rot_base</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

    <span class="c1"># set new position: </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_rot_left_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_rot_left_abs</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the rotation of the left nozzle to the absolute position in degree</p>
<p>Parameters
rot_abs : float
    abs motion in degree</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_rot_left_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_abs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the rotation of the left nozzle to the absolute position in degree</span>

<span class="sd">        Parameters</span>
<span class="sd">        rot_abs : float</span>
<span class="sd">            abs motion in degree</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set new position: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_rot_left_rel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_rot_left_rel</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the rotation of the left nozzle relative to the current position in degree</p>
<p>Parameters
rot_rel : float
    relative motion in degree</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_rot_left_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_rel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    moves the rotation of the left nozzle relative to the current position in degree</span>

<span class="sd">    Parameters</span>
<span class="sd">    rot_rel : float</span>
<span class="sd">        relative motion in degree</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get current position:</span>
    <span class="n">pos_rot_left</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

    <span class="c1"># set new position: </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_rot_right_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_rot_right_abs</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the rotation of the right nozzle to the absolute position in degree</p>
<p>Parameters
rot_abs : float
    abs motion in degree</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_rot_right_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_abs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        moves the rotation of the right nozzle to the absolute position in degree</span>

<span class="sd">        Parameters</span>
<span class="sd">        rot_abs : float</span>
<span class="sd">            abs motion in degree</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># set new position: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">rot_abs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_rot_right_rel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_rot_right_rel</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the rotation of the right nozzle relative to the current position in degree</p>
<p>Parameters
rot_rel : float
    relative motion in degree</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_rot_right_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rot_rel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    moves the rotation of the right nozzle relative to the current position in degree</span>

<span class="sd">    Parameters</span>
<span class="sd">    rot_rel : float</span>
<span class="sd">        relative motion in degree</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get current position:</span>
    <span class="n">pos_rot_right</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

    <span class="c1"># set new position: </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">rot_rel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_z_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_z_abs</span><span class="p">(</span><span class="n">z_abs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the z position to the absolute position in mm</p>
<p>Parameters
z_abs : float
    absolute motion in mm</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_z_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_abs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    moves the z position to the absolute position in mm</span>

<span class="sd">    Parameters</span>
<span class="sd">    z_abs : float</span>
<span class="sd">        absolute motion in mm</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># move z position:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">z_abs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.move_z_rel" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_z_rel</span><span class="p">(</span><span class="n">z_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>moves the z position relative to the current position </p>
<p>Parameters
z_rel : float
    relative motion in mm</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_z_rel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z_rel</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    moves the z position relative to the current position </span>

<span class="sd">    Parameters</span>
<span class="sd">    z_rel : float</span>
<span class="sd">        relative motion in mm</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get current z position:</span>
    <span class="n">pos_trans_z</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

    <span class="c1"># set new position</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">z_rel</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.remove_CoDI_pos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">remove_CoDI_pos</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>removes the defined motor combination for CoDI from local database</p>
<p>Parameters
name : str
    name of the pre-definition to be deleted</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">remove_CoDI_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    removes the defined motor combination for CoDI from local database</span>

<span class="sd">    Parameters</span>
<span class="sd">    name : str</span>
<span class="sd">        name of the pre-definition to be deleted</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.set_CoDI_current_pos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_CoDI_current_pos</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>defines or updates the current motor combination for CoDI</p>
<p>Parameters
name : str
    name of the pre-definition</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_current_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    defines or updates the current motor combination for CoDI</span>

<span class="sd">    Parameters</span>
<span class="sd">    name : str</span>
<span class="sd">        name of the pre-definition</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pos_name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.set_CoDI_current_z" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_CoDI_current_z</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>sets the current z position to all preloaded positions
Useful for global change of z after aligning</p>
<p>Parameters
verbose : Boolean
    prints the new positions as a sanity check if True</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_current_z</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    sets the current z position to all preloaded positions</span>
<span class="sd">    Useful for global change of z after aligning</span>

<span class="sd">    Parameters</span>
<span class="sd">    verbose : Boolean</span>
<span class="sd">        prints the new positions as a sanity check if True</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get current z position:</span>
    <span class="n">pos_trans_z_new</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span>

    <span class="c1"># get all keys from the positions</span>
    <span class="n">position_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="o">.</span><span class="n">keys</span>

    <span class="c1">#go through all positions and change the z-value to the current z value</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">position_keys</span><span class="p">:</span> 
        <span class="n">pos_name</span><span class="p">,</span> <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">pos_name</span><span class="p">,</span><span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z_new</span><span class="p">)</span>

    <span class="c1">#Print the new predefined positions as a sanity check</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_predefined</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.set_CoDI_pos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_CoDI_pos</span><span class="p">(</span><span class="n">pos_name</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Moves the colliding droplet injector into a pre-defined position. </p>
<p>Parameters
pos_name : string
    name of the pre-defined position
wait : boolean
    if the robot waits before continuing further steps</p>
<hr />
<p>Return :</p>

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos_name</span><span class="p">,</span> <span class="n">wait</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Moves the colliding droplet injector into a pre-defined position. </span>

<span class="sd">    Parameters</span>
<span class="sd">    pos_name : string</span>
<span class="sd">        name of the pre-defined position</span>
<span class="sd">    wait : boolean</span>
<span class="sd">        if the robot waits before continuing further steps</span>

<span class="sd">    ----------</span>
<span class="sd">    Return : </span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># pos_rot_base  = CoDI_base.wm()</span>
    <span class="c1"># pos_rot_left  = CoDI_left.wm()</span>
    <span class="c1"># pos_rot_right = CoDI_right.wm()</span>
    <span class="c1"># pos_trans_z   = CoDI_z.wm()</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="c1"># get target positions</span>
    <span class="n">pos_rot_base</span><span class="p">,</span> <span class="n">pos_rot_left</span><span class="p">,</span> <span class="n">pos_rot_right</span><span class="p">,</span> <span class="n">pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="p">[</span><span class="n">pos_name</span><span class="p">]</span>

    <span class="c1"># Move motors</span>

    <span class="c1"># Old wayy </span>
    <span class="c1"># self.CoDI_rot_base.mv(pos_rot_base, wait=False)</span>
    <span class="c1"># self.CoDI_rot_left.mv(pos_rot_left,  wait=False)</span>
    <span class="c1"># self.CoDI_rot_right.mv(pos_rot_right, wait=False)</span>
    <span class="c1"># self.CoDI_trans_z.mv(pos_trans_z, wait=False)</span>

    <span class="c1"># Move using hutch python presets</span>
    <span class="n">exec_base</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_rot_base.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">exec_base</span><span class="p">)</span>
    <span class="n">exec_left</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_rot_left.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">exec_left</span><span class="p">)</span>
    <span class="n">exec_right</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_rot_right.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">exec_right</span><span class="p">)</span>
    <span class="n">exec_z</span> <span class="o">=</span> <span class="s2">&quot;self.CoDI_trans_z.mv_&quot;</span> <span class="o">+</span> <span class="n">pos_name</span> <span class="o">+</span> <span class="s1">&#39;()&#39;</span>
    <span class="n">exec</span><span class="p">(</span><span class="n">exec_z</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">wait</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="n">test_name</span><span class="p">,</span> <span class="n">test_pos_rot_base</span><span class="p">,</span> <span class="n">test_pos_rot_left</span><span class="p">,</span> <span class="n">test_pos_rot_right</span><span class="p">,</span> <span class="n">test_pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">pos_name</span> <span class="o">!=</span> <span class="n">test_name</span><span class="p">:</span> 
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1"> waiting for motion to end: </span><span class="si">%i</span><span class="s1"> s&#39;</span> <span class="o">%</span><span class="n">i</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">test_name</span><span class="p">,</span> <span class="n">test_pos_rot_base</span><span class="p">,</span> <span class="n">test_pos_rot_left</span><span class="p">,</span> <span class="n">test_pos_rot_right</span><span class="p">,</span> <span class="n">test_pos_trans_z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Motion ended&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.set_CoDI_predefined" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>defines or updates a predefined combination for CoDI</p>
<p>Parameters
name : str
    name of the pre-definition
base : float
    rotation of base
left : float
    rotation of left injector
right : float
    rotation of right injector
z : float
    translation of right injector</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_CoDI_predefined</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    defines or updates a predefined combination for CoDI</span>

<span class="sd">    Parameters</span>
<span class="sd">    name : str</span>
<span class="sd">        name of the pre-definition</span>
<span class="sd">    base : float</span>
<span class="sd">        rotation of base</span>
<span class="sd">    left : float</span>
<span class="sd">        rotation of left injector</span>
<span class="sd">    right : float</span>
<span class="sd">        rotation of right injector</span>
<span class="sd">    z : float</span>
<span class="sd">        translation of right injector</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">name</span><span class="p">:</span> <span class="p">(</span><span class="n">base</span><span class="p">,</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">z</span><span class="p">)})</span>

    <span class="c1"># Presets using MFX presets functionalities </span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">left</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_right</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">right</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_base</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">base</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_trans_z</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">add_hutch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.CoDI.update_CoDI_predefined" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_CoDI_predefined</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>reloads all the hutch python presets for motors and overwrites local position preset dict</p>

            <details class="quote">
              <summary>Source code in <code>dod/codi.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">update_CoDI_predefined</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
    <span class="s1">&#39;reloads all the hutch python presets for motors and overwrites local position preset dict&#39;</span>

    <span class="c1">#Predefined positions CoDI</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CoDI_pos_predefined</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

    <span class="n">all_presets</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CoDI_rot_left</span><span class="o">.</span><span class="n">presets</span><span class="o">.</span><span class="n">positions</span><span class="p">)</span> <span class="c1">#Needs to be fixed</span>
    <span class="k">for</span> <span class="n">preset</span> <span class="ow">in</span> <span class="n">all_presets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span> 
        <span class="c1"># try: </span>
        <span class="c1"># get preset position</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec_base</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_base = self.CoDI_rot_base.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_left = self.CoDI_rot_left.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_right</span> <span class="o">=</span> <span class="s2">&quot;preset_rot_right = self.CoDI_rot_right.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exec_trans_z</span> <span class="o">=</span> <span class="s2">&quot;preset_trans_z = self.CoDI_trans_z.presets.positions.&quot;</span> <span class="o">+</span> <span class="n">preset</span> <span class="o">+</span> <span class="s1">&#39;.pos&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_base</span><span class="p">)</span>
        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_base</span><span class="p">)</span>

        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span><span class="p">)</span>

        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_right</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_rot_left</span><span class="p">)</span>

        <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_trans_z</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exec_trans_z</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">preset_trans_z</span><span class="p">)</span>

        <span class="c1"># Save to local database</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">preset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_CoDI_predefined</span><span class="p">(</span><span class="n">preset</span><span class="p">,</span> <span class="n">preset_rot_base</span><span class="p">,</span> <span class="n">preset_rot_left</span><span class="p">,</span> <span class="n">preset_rot_right</span><span class="p">,</span> <span class="n">preset_trans_z</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mfx.beamline.Debug" class="doc doc-heading">
            <code>Debug</code>


</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>mfx/debug.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Debug</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="n">full_ioc_serverlist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;netconfig search ioc-mfx* --brief&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="n">full_daq_serverlist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;netconfig search daq-mfx* --brief&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ioc</span> <span class="k">for</span> <span class="n">ioc</span> <span class="ow">in</span> <span class="n">full_ioc_serverlist</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ioc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
            <span class="s2">&quot;-ipmi&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ioc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;-fez&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ioc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;-ics&quot;</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ioc</span> <span class="k">for</span> <span class="n">ioc</span> <span class="ow">in</span> <span class="n">full_daq_serverlist</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">ioc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span>
            <span class="s2">&quot;-ipmi&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ioc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;-fez&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">ioc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;-ana&quot;</span><span class="p">)]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">awr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hutch</span><span class="o">=</span><span class="s1">&#39;mfx&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if the beamline is ready to take beam</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hutch: str, optional</span>
<span class="sd">            Specify the hutch you want to check. Default is MFX because it is the best</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hutch</span><span class="si">}</span><span class="s2"> Beamline Check&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/cds/group/pcds/pyps/apps/hutch-python/mfx/scripts/awr </span><span class="si">{</span><span class="n">hutch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">motor_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Powering up all available motors&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/cds/group/pcds/pyps/apps/hutch-python/mfx/scripts/mfxpowerup.sh&quot;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">check_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the status of an individual server</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server: str, required</span>
<span class="sd">            Specify the server name to check. Use debug.server_list(&#39;all&#39;) to see all servers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="n">status</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking the status of: </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/reg/g/pcds/engineering_tools/latest-released/scripts/serverStat </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The server you are looking for does not exist please select one of the following&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;ioc&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;daq&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">status</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">cycle_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cycles an individual server</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server: str, required</span>
<span class="sd">            Specify the server name to cycle. Use debug.server_list(&#39;all&#39;) to see all servers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Power cycling: </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/reg/g/pcds/engineering_tools/latest-released/scripts/serverStat </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> cycle&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The server you are looking for does not exist please select one of the following&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;ioc&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;daq&#39;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">check_all_servers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks the status of all servers local to MFX</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server_type: str, required</span>
<span class="sd">            Specify the server type input either &#39;all&#39;, &#39;ioc&#39;, or &#39;daq</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to check all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">)</span><span class="si">}</span><span class="s2"> servers.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ioc&#39;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to check all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">)</span><span class="si">}</span><span class="s2"> ioc servers.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;daq&#39;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to check all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">)</span><span class="si">}</span><span class="s2"> daq servers.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
                <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is no server of the type you requested. Please use either ioc or daq or all.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is something wrong with the following servers.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">cycle</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Would you like to power cycle all error servers? (y/n)? &quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cycle</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to cycle all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span><span class="si">}</span><span class="s2"> broken servers.&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cycle_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided not to cycle </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span><span class="si">}</span><span class="s2"> broken servers.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span><span class="si">}</span><span class="s2"> servers are ready to rock.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">server_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lists servers local to MFX</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        server_type: str, required</span>
<span class="sd">            Specify the server type input either &#39;all&#39;, &#39;ioc&#39;, or &#39;daq</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IOC SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DAQ SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ioc&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IOC SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;daq&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DAQ SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is no server of the type you requested. Please use either ioc or daq.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.Debug.awr" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">awr</span><span class="p">(</span><span class="n">hutch</span><span class="o">=</span><span class="s1">&#39;mfx&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks if the beamline is ready to take beam</p>
<h5 id="mfx.beamline.Debug.awr--parameters">Parameters</h5>
<p>hutch: str, optional
    Specify the hutch you want to check. Default is MFX because it is the best</p>

            <details class="quote">
              <summary>Source code in <code>mfx/debug.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">awr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hutch</span><span class="o">=</span><span class="s1">&#39;mfx&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks if the beamline is ready to take beam</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    hutch: str, optional</span>
<span class="sd">        Specify the hutch you want to check. Default is MFX because it is the best</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">hutch</span><span class="si">}</span><span class="s2"> Beamline Check&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/cds/group/pcds/pyps/apps/hutch-python/mfx/scripts/awr </span><span class="si">{</span><span class="n">hutch</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.Debug.check_all_servers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_all_servers</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks the status of all servers local to MFX</p>
<h5 id="mfx.beamline.Debug.check_all_servers--parameters">Parameters</h5>
<p>server_type: str, required
    Specify the server type input either 'all', 'ioc', or 'daq</p>

            <details class="quote">
              <summary>Source code in <code>mfx/debug.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_all_servers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the status of all servers local to MFX</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    server_type: str, required</span>
<span class="sd">        Specify the server type input either &#39;all&#39;, &#39;ioc&#39;, or &#39;daq</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to check all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">)</span><span class="si">}</span><span class="s2"> servers.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ioc&#39;</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to check all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">)</span><span class="si">}</span><span class="s2"> ioc servers.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>

    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;daq&#39;</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to check all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">)</span><span class="si">}</span><span class="s2"> daq servers.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;on&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;1)&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;up&#39;</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has passed all tests&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Server </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> has failed one or more tests and is added to the broken list&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">server</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is no server of the type you requested. Please use either ioc or daq or all.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is something wrong with the following servers.&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">cycle</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Would you like to power cycle all error servers? (y/n)? &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cycle</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided to cycle all </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span><span class="si">}</span><span class="s2"> broken servers.&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cycle_server</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided not to cycle </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span><span class="si">}</span><span class="s2"> broken servers.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;All </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span><span class="p">)</span><span class="si">}</span><span class="s2"> servers are ready to rock.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">error_servers</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.Debug.check_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_server</span><span class="p">(</span><span class="n">server</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks the status of an individual server</p>
<h5 id="mfx.beamline.Debug.check_server--parameters">Parameters</h5>
<p>server: str, required
    Specify the server name to check. Use debug.server_list('all') to see all servers</p>

            <details class="quote">
              <summary>Source code in <code>mfx/debug.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the status of an individual server</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    server: str, required</span>
<span class="sd">        Specify the server name to check. Use debug.server_list(&#39;all&#39;) to see all servers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="n">status</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Checking the status of: </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">popen</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/reg/g/pcds/engineering_tools/latest-released/scripts/serverStat </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> status&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The server you are looking for does not exist please select one of the following&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;ioc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;daq&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">status</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.Debug.cycle_server" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">cycle_server</span><span class="p">(</span><span class="n">server</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Cycles an individual server</p>
<h5 id="mfx.beamline.Debug.cycle_server--parameters">Parameters</h5>
<p>server: str, required
    Specify the server name to cycle. Use debug.server_list('all') to see all servers</p>

            <details class="quote">
              <summary>Source code in <code>mfx/debug.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">cycle_server</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Cycles an individual server</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    server: str, required</span>
<span class="sd">        Specify the server name to cycle. Use debug.server_list(&#39;all&#39;) to see all servers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">server</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Power cycling: </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/reg/g/pcds/engineering_tools/latest-released/scripts/serverStat </span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s2"> cycle&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The server you are looking for does not exist please select one of the following&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;ioc&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">server_list</span><span class="p">(</span><span class="s1">&#39;daq&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.Debug.server_list" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">server_list</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Lists servers local to MFX</p>
<h5 id="mfx.beamline.Debug.server_list--parameters">Parameters</h5>
<p>server_type: str, required
    Specify the server type input either 'all', 'ioc', or 'daq</p>

            <details class="quote">
              <summary>Source code in <code>mfx/debug.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">server_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">server_type</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Lists servers local to MFX</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    server_type: str, required</span>
<span class="sd">        Specify the server type input either &#39;all&#39;, &#39;ioc&#39;, or &#39;daq</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IOC SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">DAQ SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ioc&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IOC SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ioc_serverlist</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">server_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;daq&#39;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DAQ SERVERS</span><span class="se">\n</span><span class="s1">#########################&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">server</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">daq_serverlist</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">server</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;There is no server of the type you requested. Please use either ioc or daq.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mfx.beamline.DoD" class="doc doc-heading">
            <code>DoD</code>


</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>dod/dod.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DoD</span><span class="p">:</span> 
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modules</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;172.21.72.187&quot;</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">9999</span><span class="p">,</span> <span class="n">supported_json</span> <span class="o">=</span> <span class="s1">&#39;/cds/group/pcds/pyps/apps/hutch-python/mfx/dod/supported.json&#39;</span>
<span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class definition of the DoD robot</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        modules : string</span>
<span class="sd">            Defines the optional modules of the robot. </span>
<span class="sd">            Options: &#39;None&#39;, &#39;codi&#39;, , </span>
<span class="sd">        ip = &quot;172.21.72.187&quot; , port = 9999, supported_json = &quot;supported.json&quot;            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.DropsDriver</span><span class="w"> </span><span class="kn">import</span> <span class="n">myClient</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.JsonFileHandler</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonFileHandler</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.ServerResponse</span><span class="w"> </span><span class="kn">import</span> <span class="n">ServerResponse</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="c1"># Create object </span>
        <span class="c1"># pytest encourages this pattern, apologies.</span>
        <span class="c1"># ip = &quot;172.21.72.187&quot; #&quot;172.21.148.101&quot;</span>
        <span class="c1"># port = 9999</span>
        <span class="c1"># supported_json = &#39;/cds/group/pcds/pyps/apps/hutch-python/mfx/dod/supported.json&#39;</span>

        <span class="c1"># User input parameters: </span>
        <span class="c1"># Safety parameters in hutch coordinate system. </span>
        <span class="c1"># Note: hutch (x,y,z) = robot (x,-z, y) </span>
        <span class="c1"># </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_min</span>     <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># minimum value in y.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_safety</span>  <span class="o">=</span> <span class="mi">50000</span> <span class="c1"># value in y, above which the robot can only be in vertical configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span>     <span class="o">=</span> <span class="mi">50000</span> <span class="c1"># maximum value in y</span>

        <span class="c1">#Initialize safety regions for horizontal and vertical rotation: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#minimum region: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_forbidden_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="p">,</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="c1">#maximum region: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_forbidden_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="p">,</span> <span class="mi">500000</span><span class="p">,</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="c1">#region where horizontal rotation is forbidden: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_forbidden_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">y_safety</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="p">,</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

        <span class="c1"># Initializing the robot client that is used for communication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">myClient</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">supported_json</span><span class="o">=</span><span class="n">supported_json</span><span class="p">,</span> <span class="n">reload</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># create config parser handler</span>
        <span class="n">json_handler</span> <span class="o">=</span> <span class="n">JsonFileHandler</span><span class="p">(</span><span class="n">supported_json</span><span class="p">)</span>
        <span class="c1"># load configs and launch web server</span>
        <span class="n">json_handler</span><span class="o">.</span><span class="n">reload_endpoints</span><span class="p">()</span>

        <span class="c1"># Flag that can be used later on for safety aborts during task execution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">modules</span> <span class="o">==</span> <span class="s1">&#39;codi&#39;</span><span class="p">:</span> 
            <span class="kn">from</span><span class="w"> </span><span class="nn">dod.codi</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoDI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">codi</span> <span class="o">=</span> <span class="n">CoDI</span><span class="p">()</span>

        <span class="c1"># Timing section</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.evr</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Trigger objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_Xray</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG7&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_X-ray_simulator&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_1</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG2&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_nozzle_1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_2</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG3&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_nozzle_2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_LED</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG1&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_LED_array&#39;</span><span class="p">)</span>

        <span class="c1"># Timing parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_Xray</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_1</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_2</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_LED</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">=</span> <span class="mi">60600</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">#delay of LED relative to X-ray timing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">stop_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Stop task while running</span>
<span class="sd">        ** ISSUES **</span>
<span class="sd">        -  When stop task  is called, the Robot stays in &quot;BUSY&quot; Status.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">            status readback when aborted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_task</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">clear_abort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        clear abort flag</span>
<span class="sd">        Parameters</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">           Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">            status readback after error cleared</span>
<span class="sd">        &#39;&#39;&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>


    <span class="c1"># def clear_popup_window(self, verbose = True):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     clears a popup window that might pop up on the robot gui</span>
    <span class="c1">#     Parameters</span>
    <span class="c1">#     verbose : boolean</span>
    <span class="c1">#        Defines whether the function returns the full output, or only the results</span>
    <span class="c1">#     ----------</span>
    <span class="c1">#     Returns: </span>
    <span class="c1">#     r : </span>
    <span class="c1">#         status readback after error cleared</span>
    <span class="c1">#     &#39;&#39;&#39;</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     r = self.client.connect(&quot;Test&quot;)</span>
    <span class="c1">#     r = self.client.get_status()</span>

    <span class="c1">#     self.client.close_dialog(reference, selection)</span>

    <span class="c1">#     if verbose == True: </span>
    <span class="c1">#         return r</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns the robot state</span>

<span class="sd">        Parameters</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">           Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : dict</span>
<span class="sd">            different states of the robot</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="c1"># expected_keys = [</span>
        <span class="c1">#     &#39;Position&#39;,</span>
        <span class="c1">#     &#39;RunningTask&#39;,</span>
        <span class="c1">#     &#39;Dialog&#39;,</span>
        <span class="c1">#     &#39;LastProbe&#39;,</span>
        <span class="c1">#     &#39;Humidity&#39;,</span>
        <span class="c1">#     &#39;Temperature&#39;,</span>
        <span class="c1">#     &#39;BathTemp&#39;,</span>
        <span class="c1">#     ]</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">busy_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Busy wait untill timeout value is reached,</span>
<span class="sd">            timeout : sec</span>
<span class="sd">            returns true if timeout occured</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">STATUS</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Busy&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">timeout</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1">#Wait a ms to stop spamming robot</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>    
        <span class="k">return</span> <span class="kc">False</span>


    <span class="c1"># def __del__(self):</span>
    <span class="c1">#     # close network connection</span>
    <span class="c1">#     self.client.conn.close()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_task_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_name</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This gets the details of a task from the robot to see the scripted routines</span>
<span class="sd">            Parameters</span>
<span class="sd">            task_name : string</span>
<span class="sd">                Name of the task that we want to get</span>
<span class="sd">            verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">            Returns: </span>
<span class="sd">            r : </span>
<span class="sd">                returns the robot tasks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_task_details</span><span class="p">(</span><span class="n">task_name</span><span class="p">)</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_task_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            This gets the names of available tasks from the robot</span>
<span class="sd">            Parameters</span>
<span class="sd">            task_name : string</span>
<span class="sd">                Name of the task that we want to get</span>
<span class="sd">            verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">            Returns: </span>
<span class="sd">            r : dict</span>
<span class="sd">                returns the robot tasks</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if reponse is not an empty array or any errors occured</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_task_names</span><span class="p">()</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns current robot position</span>
<span class="sd">        name and properties of the last selected position, together with the real current position coordinates</span>
<span class="sd">        Parameters</span>

<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">            returns the current position.         </span>
<span class="sd">        # expected_keys = [</span>
<span class="sd">        #         &#39;CurrentPosition&#39;,</span>
<span class="sd">        #         &#39;Position&#39;,</span>
<span class="sd">        #         &#39;PositionReal&#39;,</span>
<span class="sd">        #         ]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_nozzle_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Returns current nozzle parameters position</span>
<span class="sd">        Parameters</span>

<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">            returns the current nozzle parameters.         </span>
<span class="sd">        #         expected_keys = [</span>
<span class="sd">                &quot;Activated Nozzles&quot;,</span>
<span class="sd">                &quot;Selected Nozzles&quot;,</span>
<span class="sd">                &quot;ID,Volt,Pulse,Freq,Volume&quot;,  # Intreseting? all one key</span>
<span class="sd">                &quot;Dispensing&quot;,</span>
<span class="sd">                ]</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_nozzle_status</span><span class="p">()</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_nozzle_dispensing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Sets the dispensing, either &quot;Free&quot;, &quot;Triggered&quot;, or &quot;Off&quot;</span>
<span class="sd">        Parameters</span>
<span class="sd">        mode : string </span>
<span class="sd">            either &quot;free&quot;, &quot;triggered&quot;, or &quot;off&quot;</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Free&#39;</span><span class="p">:</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Free&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Triggered&#39;</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Triggered&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="c1">#turns active nozzles off. Safer if all nozzles would be turned off</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span> 
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">select_nozzle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>

        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">do_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Moves robot to new position</span>

<span class="sd">        Parameters</span>
<span class="sd">        position : string</span>
<span class="sd">            Position name to which the robot is supposed to move</span>
<span class="sd">        safety_test : Boolean</span>
<span class="sd">            question whether a safety test is to be performed or not</span>
<span class="sd">            True: Test will be performed</span>
<span class="sd">            False: Not performed</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : current position</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
        <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>

        <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
        <span class="n">new_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>

        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_x_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_x</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Robot coordinate system!!!: </span>
<span class="sd">            Moves robot to new absolute x position. </span>
<span class="sd">            No safety test. </span>

<span class="sd">        Parameters</span>
<span class="sd">        position : int</span>
<span class="sd">            Absolute position in um(?) to which the robot is supposed to move</span>
<span class="sd">        safety_test : Boolean</span>
<span class="sd">            question whether a safety test is to be performed or not</span>
<span class="sd">            True: Test will be performed</span>
<span class="sd">            False: Not performed</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : current position</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
        <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>
        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">z_current</span> <span class="o">=</span> <span class="n">current_real_position</span>

        <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_x</span><span class="p">(</span><span class="n">position_x</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">position_x</span><span class="p">,</span> <span class="n">y_current</span><span class="p">):</span> 
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_x</span><span class="p">(</span><span class="n">position_x</span><span class="p">)</span>


        <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

        <span class="c1"># r = self.client.get_current_positions()</span>
        <span class="c1"># new_real_position = r.RESULTS[&#39;PositionReal&#39;]</span>

        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_y_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_y</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Robot coordinate system!!!: </span>
<span class="sd">            Moves robot to new absolute x position. </span>
<span class="sd">            No safety test. </span>

<span class="sd">        Parameters</span>
<span class="sd">        position : int</span>
<span class="sd">            Absolute position in um(?) to which the robot is supposed to move</span>
<span class="sd">        safety_test : Boolean</span>
<span class="sd">            question whether a safety test is to be performed or not</span>
<span class="sd">            True: Test will be performed</span>
<span class="sd">            False: Not performed</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : current position</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
        <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>
        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">z_current</span> <span class="o">=</span> <span class="n">current_real_position</span>

        <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_y</span><span class="p">(</span><span class="n">position_y</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">position_y</span><span class="p">):</span> 
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_y</span><span class="p">(</span><span class="n">position_y</span><span class="p">)</span>


        <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

        <span class="c1"># r = self.client.get_current_positions()</span>
        <span class="c1"># new_real_position = r.RESULTS[&#39;PositionReal&#39;]</span>

        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">move_z_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_z</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            Robot coordinate system!!!: </span>
<span class="sd">            Moves robot to new absolute Z position. </span>
<span class="sd">            No safety test. </span>

<span class="sd">        Parameters</span>
<span class="sd">        position : int</span>
<span class="sd">            Absolute position in um(?) to which the robot is supposed to move</span>
<span class="sd">        safety_test : Boolean</span>
<span class="sd">            question whether a safety test is to be performed or not</span>
<span class="sd">            True: Test will be performed</span>
<span class="sd">            False: Not performed</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : current position</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
        <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>
        <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">z_current</span> <span class="o">=</span> <span class="n">current_real_position</span>

        <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_z</span><span class="p">(</span><span class="n">position_z</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">):</span> 
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_z</span><span class="p">(</span><span class="n">position_z</span><span class="p">)</span>


        <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

        <span class="c1"># r = self.client.get_current_positions()</span>
        <span class="c1"># new_real_position = r.RESULTS[&#39;PositionReal&#39;]</span>

        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">do_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_name</span><span class="p">,</span> <span class="n">safety_check</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Executes a task of the robot</span>

<span class="sd">        Parameters</span>
<span class="sd">        task_name : string</span>
<span class="sd">            task name which robot is supposed to perform</span>
<span class="sd">        safety_test : Boolean</span>
<span class="sd">            question whether a safety test is to be performed or not</span>
<span class="sd">            True: Test will be performed</span>
<span class="sd">            False: Not performed</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">                Defines whether the function returns the full output, or only the results</span>
<span class="sd">            ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">safety_check</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">execute_task</span><span class="p">(</span><span class="n">task_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety check needs to be implemented&#39;</span><span class="p">)</span>

        <span class="c1">## Wait for task to be done</span>
        <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">STATUS</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Busy&quot;</span><span class="p">):</span>
            <span class="c1">#Possible if loop is not enterd?</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
                <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_task</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;User aborted task execution&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">r</span>

        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>

        <span class="c1">#Check if any error occured</span>
        <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">ERROR_CODE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no error&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error while performing task!&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">get_forbidden_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_state</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        returns forbidden regions in the robot coordinate x y plane for end-point testing </span>
<span class="sd">        defined via a rectangle in the x-y-plane. x_start&lt;x_stop, y_start&lt;y_stop</span>
<span class="sd">        returns the region depending on the rotation state, as some regions are forbidden only in one configuration</span>

<span class="sd">        Parameters</span>
<span class="sd">        rotation_state: string</span>
<span class="sd">            options are &quot;horizontal&quot; (nozzle sideways, base 90 degrees), &quot;vertical&quot; (nozzle vertical, base 0 degree), &quot;both&quot;</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1">#combine the lists depending on the rotation </span>
        <span class="k">if</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span> 
            <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>
        <span class="k">elif</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span> 
            <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>

        <span class="k">return</span> <span class="n">test_list_safety</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_forbidden_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">,</span> <span class="n">rotation_state</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        set a forbidden region in the robot coordinate x y plane for end-point testing </span>
<span class="sd">        defined via a rectangle in the x-y-plane. x_start&lt;x_stop, y_start&lt;y_stop</span>
<span class="sd">        set the region depending on the rotation state, as some regions are forbidden only in one configuration</span>

<span class="sd">        Parameters</span>
<span class="sd">        x_start : float</span>
<span class="sd">            x-position start </span>
<span class="sd">        x_stop : float</span>
<span class="sd">            x-position stop</span>
<span class="sd">        y_start : float</span>
<span class="sd">            y-position start </span>
<span class="sd">        y_stop : float</span>
<span class="sd">            y-position stop</span>
<span class="sd">        rotation_state: string</span>
<span class="sd">            options are &quot;horizontal&quot; (nozzle sideways, base 90 degrees), &quot;vertical&quot; (nozzle vertical, base 0 degree), &quot;both&quot;</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">region_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_stop</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_stop</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_start</span><span class="p">,</span><span class="n">y_stop</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_start</span><span class="p">,</span><span class="n">y_stop</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid input of rotation state&#39;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">test_forbidden_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        tests if the end point of a motion is inside a forbidden region</span>
<span class="sd">        No testing of the path of a motion included!</span>

<span class="sd">        Parameters</span>
<span class="sd">        x_test : float</span>
<span class="sd">            x-position to test </span>
<span class="sd">        y_test : float </span>
<span class="sd">            y-position to test </span>

<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        safe_motion : bool</span>
<span class="sd">            boolean flag if endpoint of motion is safe or not</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.codi</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoDI_base</span>
        <span class="c1"># Get current rotation state</span>
        <span class="n">pos_rot_base</span>  <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">CoDI_base</span><span class="o">.</span><span class="n">wm</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1">#Initialize safe flag (True = safe)</span>
        <span class="n">flag_safe_endpoint</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1">#combine the lists depending on the rotation </span>
        <span class="k">if</span> <span class="n">pos_rot_base</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span> 
            <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>
        <span class="k">elif</span> <span class="n">pos_rot_base</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>

        <span class="c1">#Test for all regions if the end point is in the forbidden region</span>
        <span class="k">for</span> <span class="n">tuple_current</span> <span class="ow">in</span> <span class="n">test_list_safety</span><span class="p">:</span> 
            <span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span> <span class="o">=</span> <span class="n">tuple_current</span>
            <span class="k">if</span> <span class="p">((</span><span class="n">x_start</span> <span class="o">&lt;</span> <span class="n">x_test</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x_stop</span> <span class="o">&gt;</span> <span class="n">x_test</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y_start</span> <span class="o">&lt;</span> <span class="n">y_test</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y_stop</span> <span class="o">&gt;</span> <span class="n">y_test</span><span class="p">)):</span> 
                <span class="n">flag_safe_endpoint</span> <span class="o">=</span> <span class="n">flag_safe_endpoint</span> <span class="ow">and</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flag_safe_endpoint</span> <span class="o">=</span> <span class="n">flag_safe_endpoint</span> <span class="ow">and</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="n">flag_safe_endpoint</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_timing_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        updating the timing triggers according to the set relative and absolute timing values</span>

<span class="sd">        Parameters</span>
<span class="sd">               ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Nozzle 1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="o">*</span><span class="mi">1000000000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_1</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span><span class="p">)</span>

        <span class="c1"># Nozzle 2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="o">*</span><span class="mi">1000000000</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_2</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span><span class="p">)</span>

        <span class="c1"># LED</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_LED</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_timing_zero_nozzle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nozzle</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting the time zero for the nozzles from the LED alignment in robot</span>

<span class="sd">        Parameters</span>
<span class="sd">        nozle : int</span>
<span class="sd">            nozzle number</span>
<span class="sd">        timing_rel : float</span>
<span class="sd">            relative delay in ns from robot alignment</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">=</span> <span class="n">timing_rel</span>
        <span class="k">elif</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">=</span> <span class="n">timing_rel</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no valid nozzle selected.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># update timings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_timing_rel_LED</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting the relative timing of the LED relative to the X-rays</span>

<span class="sd">        Parameters</span>
<span class="sd">        timing_rel : float</span>
<span class="sd">            relative delay in ns from robot alignment</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span> <span class="o">=</span> <span class="n">timing_rel</span> <span class="c1">#delay of LED relative to X-ray timing</span>

        <span class="c1"># update timings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_timing_rel_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting the relative timing of the reaction relative to the X-rays</span>

<span class="sd">        Parameters</span>
<span class="sd">        timing_rel : float</span>
<span class="sd">            relative delay in ns from robot alignment</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span> <span class="o">=</span> <span class="n">timing_rel</span> <span class="c1">#delay of LED relative to X-ray timing</span>

        <span class="c1"># update timings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_timing_abs_Xray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing_abs</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Setting the absolute timing of the X-rays for claculation purposes</span>

<span class="sd">        Parameters</span>
<span class="sd">        timing_abs : float</span>
<span class="sd">            abs timing in ns from robot alignment</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">=</span> <span class="n">timing_abs</span> <span class="c1">#delay of LED relative to X-ray timing</span>
        <span class="c1">#self.trigger_Xray.ns_delay.put(self.timing_Xray)</span>

        <span class="c1"># update timings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_timing_relative_nozzle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nozzle</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Changing the timing of the selected nozzle by a relative amount </span>

<span class="sd">        Parameters</span>
<span class="sd">        nozle : int</span>
<span class="sd">            nozzle number</span>
<span class="sd">        timing_rel : float</span>
<span class="sd">            relative change in ns from robot alignment</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="n">current_timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">+</span> <span class="n">timing_rel</span>
        <span class="k">elif</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> 
            <span class="n">current_timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">+</span> <span class="n">timing_rel</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no valid nozzle selected.&#39;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># update timings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">logging_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creating the string to post to the e-log. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        post : string</span>
<span class="sd">            String with useful logging information for posting into the e-log </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># Info to be posted: </span>

        <span class="c1"># Nozzle angles: </span>
        <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codi</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
        <span class="n">position_str</span> <span class="o">=</span> <span class="s1">&#39;Codi Information: </span><span class="se">\n</span><span class="s1"> CoDI data: name: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> rot_base: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> rot_left: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> rot_right: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> z-transl: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> 
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="n">position_str</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>

        <span class="c1">#Timings:</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;Timing:&#39;</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_Xray:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_nozzle_1:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_nozzle_2:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_LED:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_LED:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_reaction:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>        
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_nozzle_1:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>   
        <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_nozzle_2:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>   

        <span class="k">return</span> <span class="n">post_str</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">modules</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">ip</span><span class="o">=</span><span class="s1">&#39;172.21.72.187&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">9999</span><span class="p">,</span> <span class="n">supported_json</span><span class="o">=</span><span class="s1">&#39;/cds/group/pcds/pyps/apps/hutch-python/mfx/dod/supported.json&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Class definition of the DoD robot
Parameters</p>
<hr />
<p>modules : string
    Defines the optional modules of the robot. 
    Options: 'None', 'codi', , 
ip = "172.21.72.187" , port = 9999, supported_json = "supported.json"</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">modules</span> <span class="o">=</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">ip</span> <span class="o">=</span> <span class="s2">&quot;172.21.72.187&quot;</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="mi">9999</span><span class="p">,</span> <span class="n">supported_json</span> <span class="o">=</span> <span class="s1">&#39;/cds/group/pcds/pyps/apps/hutch-python/mfx/dod/supported.json&#39;</span>
<span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class definition of the DoD robot</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        modules : string</span>
<span class="sd">            Defines the optional modules of the robot. </span>
<span class="sd">            Options: &#39;None&#39;, &#39;codi&#39;, , </span>
<span class="sd">        ip = &quot;172.21.72.187&quot; , port = 9999, supported_json = &quot;supported.json&quot;            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.DropsDriver</span><span class="w"> </span><span class="kn">import</span> <span class="n">myClient</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.JsonFileHandler</span><span class="w"> </span><span class="kn">import</span> <span class="n">JsonFileHandler</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">dod.ServerResponse</span><span class="w"> </span><span class="kn">import</span> <span class="n">ServerResponse</span>

        <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

        <span class="c1"># Create object </span>
        <span class="c1"># pytest encourages this pattern, apologies.</span>
        <span class="c1"># ip = &quot;172.21.72.187&quot; #&quot;172.21.148.101&quot;</span>
        <span class="c1"># port = 9999</span>
        <span class="c1"># supported_json = &#39;/cds/group/pcds/pyps/apps/hutch-python/mfx/dod/supported.json&#39;</span>

        <span class="c1"># User input parameters: </span>
        <span class="c1"># Safety parameters in hutch coordinate system. </span>
        <span class="c1"># Note: hutch (x,y,z) = robot (x,-z, y) </span>
        <span class="c1"># </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_min</span>     <span class="o">=</span> <span class="mi">10000</span> <span class="c1"># minimum value in y.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_safety</span>  <span class="o">=</span> <span class="mi">50000</span> <span class="c1"># value in y, above which the robot can only be in vertical configuration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span>     <span class="o">=</span> <span class="mi">50000</span> <span class="c1"># maximum value in y</span>

        <span class="c1">#Initialize safety regions for horizontal and vertical rotation: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1">#minimum region: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_forbidden_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_min</span><span class="p">,</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="c1">#maximum region: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_forbidden_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="p">,</span> <span class="mi">500000</span><span class="p">,</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
        <span class="c1">#region where horizontal rotation is forbidden: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_forbidden_region</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300000</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">y_safety</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_max</span><span class="p">,</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span>

        <span class="c1"># Initializing the robot client that is used for communication</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">myClient</span><span class="p">(</span><span class="n">ip</span><span class="o">=</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">supported_json</span><span class="o">=</span><span class="n">supported_json</span><span class="p">,</span> <span class="n">reload</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># create config parser handler</span>
        <span class="n">json_handler</span> <span class="o">=</span> <span class="n">JsonFileHandler</span><span class="p">(</span><span class="n">supported_json</span><span class="p">)</span>
        <span class="c1"># load configs and launch web server</span>
        <span class="n">json_handler</span><span class="o">.</span><span class="n">reload_endpoints</span><span class="p">()</span>

        <span class="c1"># Flag that can be used later on for safety aborts during task execution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">modules</span> <span class="o">==</span> <span class="s1">&#39;codi&#39;</span><span class="p">:</span> 
            <span class="kn">from</span><span class="w"> </span><span class="nn">dod.codi</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoDI</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">codi</span> <span class="o">=</span> <span class="n">CoDI</span><span class="p">()</span>

        <span class="c1"># Timing section</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.evr</span><span class="w"> </span><span class="kn">import</span> <span class="n">Trigger</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delay</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Trigger objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_Xray</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG7&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_X-ray_simulator&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_1</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG2&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_nozzle_1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_2</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG3&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_nozzle_2&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trigger_LED</span> <span class="o">=</span> <span class="n">Trigger</span><span class="p">(</span><span class="s1">&#39;MFX:LAS:EVR:01:TRIG1&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;trigger_LED_array&#39;</span><span class="p">)</span>

        <span class="c1"># Timing parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_Xray</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_1</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_2</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trigger_LED</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">=</span> <span class="mi">60600</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1">#delay of LED relative to X-ray timing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.busy_wait" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">busy_wait</span><span class="p">(</span><span class="n">timeout</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Busy wait untill timeout value is reached,
timeout : sec
returns true if timeout occured</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">busy_wait</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Busy wait untill timeout value is reached,</span>
<span class="sd">        timeout : sec</span>
<span class="sd">        returns true if timeout occured</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">STATUS</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Busy&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="n">timeout</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span> <span class="c1">#Wait a ms to stop spamming robot</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span>    
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.clear_abort" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">clear_abort</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>clear abort flag
Parameters
verbose : boolean
   Defines whether the function returns the full output, or only the results</p>
<hr />
<p>Returns: 
r : 
    status readback after error cleared
'''</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">clear_abort</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    clear abort flag</span>
<span class="sd">    Parameters</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">       Defines whether the function returns the full output, or only the results</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : </span>
<span class="sd">        status readback after error cleared</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.do_move" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">do_move</span><span class="p">(</span><span class="n">position</span><span class="p">,</span> <span class="n">safety_test</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <pre><code>Moves robot to new position
</code></pre>
<p>Parameters
position : string
    Position name to which the robot is supposed to move
safety_test : Boolean
    question whether a safety test is to be performed or not
    True: Test will be performed
    False: Not performed
verbose : boolean
        Defines whether the function returns the full output, or only the results
    ----------
Returns: 
r : current position</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">do_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Moves robot to new position</span>

<span class="sd">    Parameters</span>
<span class="sd">    position : string</span>
<span class="sd">        Position name to which the robot is supposed to move</span>
<span class="sd">    safety_test : Boolean</span>
<span class="sd">        question whether a safety test is to be performed or not</span>
<span class="sd">        True: Test will be performed</span>
<span class="sd">        False: Not performed</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : current position</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
    <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>

    <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
    <span class="n">new_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.do_task" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">do_task</span><span class="p">(</span><span class="n">task_name</span><span class="p">,</span> <span class="n">safety_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Executes a task of the robot</p>
<p>Parameters
task_name : string
    task name which robot is supposed to perform
safety_test : Boolean
    question whether a safety test is to be performed or not
    True: Test will be performed
    False: Not performed
verbose : boolean
        Defines whether the function returns the full output, or only the results
    ----------
Returns: 
r :</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">do_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_name</span><span class="p">,</span> <span class="n">safety_check</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Executes a task of the robot</span>

<span class="sd">    Parameters</span>
<span class="sd">    task_name : string</span>
<span class="sd">        task name which robot is supposed to perform</span>
<span class="sd">    safety_test : Boolean</span>
<span class="sd">        question whether a safety test is to be performed or not</span>
<span class="sd">        True: Test will be performed</span>
<span class="sd">        False: Not performed</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">time</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">safety_check</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> 
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">execute_task</span><span class="p">(</span><span class="n">task_name</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety check needs to be implemented&#39;</span><span class="p">)</span>

    <span class="c1">## Wait for task to be done</span>
    <span class="k">while</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">STATUS</span><span class="p">[</span><span class="s1">&#39;Status&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Busy&quot;</span><span class="p">):</span>
        <span class="c1">#Possible if loop is not enterd?</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_task</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;User aborted task execution&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">r</span>

    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>

    <span class="c1">#Check if any error occured</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">ERROR_CODE</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no error&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error while performing task!&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.get_current_position" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_current_position</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns current robot position
name and properties of the last selected position, together with the real current position coordinates
Parameters</p>


<details class="verbose-" open>
  <summary>boolean</summary>
  <p>Defines whether the function returns the full output, or only the results</p>
</details>        <pre><code>----------
</code></pre>
<p>Returns: 
r : 
    returns the current position.         </p>
<h4 id="mfx.beamline.DoD.get_current_position--expected_keys">expected_keys = [</h4>
<h4 id="mfx.beamline.DoD.get_current_position--currentposition">'CurrentPosition',</h4>
<h4 id="mfx.beamline.DoD.get_current_position--position">'Position',</h4>
<h4 id="mfx.beamline.DoD.get_current_position--positionreal">'PositionReal',</h4>
<h4 id="mfx.beamline.DoD.get_current_position--_1">]</h4>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns current robot position</span>
<span class="sd">    name and properties of the last selected position, together with the real current position coordinates</span>
<span class="sd">    Parameters</span>

<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : </span>
<span class="sd">        returns the current position.         </span>
<span class="sd">    # expected_keys = [</span>
<span class="sd">    #         &#39;CurrentPosition&#39;,</span>
<span class="sd">    #         &#39;Position&#39;,</span>
<span class="sd">    #         &#39;PositionReal&#39;,</span>
<span class="sd">    #         ]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.get_forbidden_region" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_forbidden_region</span><span class="p">(</span><span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>returns forbidden regions in the robot coordinate x y plane for end-point testing 
defined via a rectangle in the x-y-plane. x_start&lt;x_stop, y_start&lt;y_stop
returns the region depending on the rotation state, as some regions are forbidden only in one configuration</p>
<p>Parameters
rotation_state: string
    options are "horizontal" (nozzle sideways, base 90 degrees), "vertical" (nozzle vertical, base 0 degree), "both"</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_forbidden_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_state</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns forbidden regions in the robot coordinate x y plane for end-point testing </span>
<span class="sd">    defined via a rectangle in the x-y-plane. x_start&lt;x_stop, y_start&lt;y_stop</span>
<span class="sd">    returns the region depending on the rotation state, as some regions are forbidden only in one configuration</span>

<span class="sd">    Parameters</span>
<span class="sd">    rotation_state: string</span>
<span class="sd">        options are &quot;horizontal&quot; (nozzle sideways, base 90 degrees), &quot;vertical&quot; (nozzle vertical, base 0 degree), &quot;both&quot;</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#combine the lists depending on the rotation </span>
    <span class="k">if</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span> 
        <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>
    <span class="k">elif</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span> 
        <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>

    <span class="k">return</span> <span class="n">test_list_safety</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.get_nozzle_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_nozzle_status</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns current nozzle parameters position
Parameters</p>


<details class="verbose-" open>
  <summary>boolean</summary>
  <p>Defines whether the function returns the full output, or only the results</p>
</details>        <hr />
<p>Returns: 
r : 
    returns the current nozzle parameters.         </p>
<h4 id="mfx.beamline.DoD.get_nozzle_status--expected_keys">expected_keys = [</h4>
<pre><code>    "Activated Nozzles",
    "Selected Nozzles",
    "ID,Volt,Pulse,Freq,Volume",  # Intreseting? all one key
    "Dispensing",
    ]
</code></pre>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_nozzle_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns current nozzle parameters position</span>
<span class="sd">    Parameters</span>

<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : </span>
<span class="sd">        returns the current nozzle parameters.         </span>
<span class="sd">    #         expected_keys = [</span>
<span class="sd">            &quot;Activated Nozzles&quot;,</span>
<span class="sd">            &quot;Selected Nozzles&quot;,</span>
<span class="sd">            &quot;ID,Volt,Pulse,Freq,Volume&quot;,  # Intreseting? all one key</span>
<span class="sd">            &quot;Dispensing&quot;,</span>
<span class="sd">            ]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_nozzle_status</span><span class="p">()</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.get_status" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_status</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>returns the robot state</p>
<p>Parameters
verbose : boolean
   Defines whether the function returns the full output, or only the results</p>
<hr />
<p>Returns: 
r : dict
    different states of the robot</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    returns the robot state</span>

<span class="sd">    Parameters</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">       Defines whether the function returns the full output, or only the results</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : dict</span>
<span class="sd">        different states of the robot</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_status</span><span class="p">()</span>
    <span class="c1"># expected_keys = [</span>
    <span class="c1">#     &#39;Position&#39;,</span>
    <span class="c1">#     &#39;RunningTask&#39;,</span>
    <span class="c1">#     &#39;Dialog&#39;,</span>
    <span class="c1">#     &#39;LastProbe&#39;,</span>
    <span class="c1">#     &#39;Humidity&#39;,</span>
    <span class="c1">#     &#39;Temperature&#39;,</span>
    <span class="c1">#     &#39;BathTemp&#39;,</span>
    <span class="c1">#     ]</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.get_task_details" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_task_details</span><span class="p">(</span><span class="n">task_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This gets the details of a task from the robot to see the scripted routines
Parameters
task_name : string
    Name of the task that we want to get
verbose : boolean
    Defines whether the function returns the full output, or only the results</p>
<hr />
<p>Returns: 
r : 
    returns the robot tasks</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_task_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">task_name</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This gets the details of a task from the robot to see the scripted routines</span>
<span class="sd">        Parameters</span>
<span class="sd">        task_name : string</span>
<span class="sd">            Name of the task that we want to get</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : </span>
<span class="sd">            returns the robot tasks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_task_details</span><span class="p">(</span><span class="n">task_name</span><span class="p">)</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.get_task_names" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_task_names</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>This gets the names of available tasks from the robot
Parameters
task_name : string
    Name of the task that we want to get
verbose : boolean
    Defines whether the function returns the full output, or only the results</p>
<hr />
<p>Returns: 
r : dict
    returns the robot tasks</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_task_names</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This gets the names of available tasks from the robot</span>
<span class="sd">        Parameters</span>
<span class="sd">        task_name : string</span>
<span class="sd">            Name of the task that we want to get</span>
<span class="sd">        verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">        Returns: </span>
<span class="sd">        r : dict</span>
<span class="sd">            returns the robot tasks</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if reponse is not an empty array or any errors occured</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_task_names</span><span class="p">()</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.logging_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">logging_string</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Creating the string to post to the e-log. </p>
<h5 id="mfx.beamline.DoD.logging_string--parameters">Parameters</h5>
<p>Returns: 
post : string
    String with useful logging information for posting into the e-log</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">logging_string</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creating the string to post to the e-log. </span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    post : string</span>
<span class="sd">        String with useful logging information for posting into the e-log </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="c1"># Info to be posted: </span>

    <span class="c1"># Nozzle angles: </span>
    <span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codi</span><span class="o">.</span><span class="n">get_CoDI_pos</span><span class="p">()</span>
    <span class="n">position_str</span> <span class="o">=</span> <span class="s1">&#39;Codi Information: </span><span class="se">\n</span><span class="s1"> CoDI data: name: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> rot_base: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> rot_left: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> rot_right: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> z-transl: &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">position</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> 
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="n">position_str</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>

    <span class="c1">#Timings:</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;Timing:&#39;</span> <span class="o">+</span> <span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_Xray:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_nozzle_1:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_nozzle_2:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_LED:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_LED:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_reaction:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>        
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_nozzle_1:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>   
    <span class="n">post_str</span> <span class="o">=</span> <span class="n">post_str</span> <span class="o">+</span> <span class="s1">&#39;timing_delay_nozzle_2:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39; </span><span class="se">\n</span><span class="s1"> &#39;</span>   

    <span class="k">return</span> <span class="n">post_str</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.move_x_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_x_abs</span><span class="p">(</span><span class="n">position_x</span><span class="p">,</span> <span class="n">safety_test</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <pre><code>Robot coordinate system!!!: 
Moves robot to new absolute x position. 
No safety test.
</code></pre>
<p>Parameters
position : int
    Absolute position in um(?) to which the robot is supposed to move
safety_test : Boolean
    question whether a safety test is to be performed or not
    True: Test will be performed
    False: Not performed
verbose : boolean
        Defines whether the function returns the full output, or only the results
    ----------
Returns: 
r : current position</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_x_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_x</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Robot coordinate system!!!: </span>
<span class="sd">        Moves robot to new absolute x position. </span>
<span class="sd">        No safety test. </span>

<span class="sd">    Parameters</span>
<span class="sd">    position : int</span>
<span class="sd">        Absolute position in um(?) to which the robot is supposed to move</span>
<span class="sd">    safety_test : Boolean</span>
<span class="sd">        question whether a safety test is to be performed or not</span>
<span class="sd">        True: Test will be performed</span>
<span class="sd">        False: Not performed</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : current position</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
    <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>
    <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">z_current</span> <span class="o">=</span> <span class="n">current_real_position</span>

    <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_x</span><span class="p">(</span><span class="n">position_x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">position_x</span><span class="p">,</span> <span class="n">y_current</span><span class="p">):</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_x</span><span class="p">(</span><span class="n">position_x</span><span class="p">)</span>


    <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

    <span class="c1"># r = self.client.get_current_positions()</span>
    <span class="c1"># new_real_position = r.RESULTS[&#39;PositionReal&#39;]</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.move_y_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_y_abs</span><span class="p">(</span><span class="n">position_y</span><span class="p">,</span> <span class="n">safety_test</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <pre><code>Robot coordinate system!!!: 
Moves robot to new absolute x position. 
No safety test.
</code></pre>
<p>Parameters
position : int
    Absolute position in um(?) to which the robot is supposed to move
safety_test : Boolean
    question whether a safety test is to be performed or not
    True: Test will be performed
    False: Not performed
verbose : boolean
        Defines whether the function returns the full output, or only the results
    ----------
Returns: 
r : current position</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_y_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_y</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Robot coordinate system!!!: </span>
<span class="sd">        Moves robot to new absolute x position. </span>
<span class="sd">        No safety test. </span>

<span class="sd">    Parameters</span>
<span class="sd">    position : int</span>
<span class="sd">        Absolute position in um(?) to which the robot is supposed to move</span>
<span class="sd">    safety_test : Boolean</span>
<span class="sd">        question whether a safety test is to be performed or not</span>
<span class="sd">        True: Test will be performed</span>
<span class="sd">        False: Not performed</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : current position</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
    <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>
    <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">z_current</span> <span class="o">=</span> <span class="n">current_real_position</span>

    <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_y</span><span class="p">(</span><span class="n">position_y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">position_y</span><span class="p">):</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_y</span><span class="p">(</span><span class="n">position_y</span><span class="p">)</span>


    <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

    <span class="c1"># r = self.client.get_current_positions()</span>
    <span class="c1"># new_real_position = r.RESULTS[&#39;PositionReal&#39;]</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.move_z_abs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">move_z_abs</span><span class="p">(</span><span class="n">position_z</span><span class="p">,</span> <span class="n">safety_test</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <pre><code>Robot coordinate system!!!: 
Moves robot to new absolute Z position. 
No safety test.
</code></pre>
<p>Parameters
position : int
    Absolute position in um(?) to which the robot is supposed to move
safety_test : Boolean
    question whether a safety test is to be performed or not
    True: Test will be performed
    False: Not performed
verbose : boolean
        Defines whether the function returns the full output, or only the results
    ----------
Returns: 
r : current position</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">move_z_abs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position_z</span><span class="p">,</span> <span class="n">safety_test</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Robot coordinate system!!!: </span>
<span class="sd">        Moves robot to new absolute Z position. </span>
<span class="sd">        No safety test. </span>

<span class="sd">    Parameters</span>
<span class="sd">    position : int</span>
<span class="sd">        Absolute position in um(?) to which the robot is supposed to move</span>
<span class="sd">    safety_test : Boolean</span>
<span class="sd">        question whether a safety test is to be performed or not</span>
<span class="sd">        True: Test will be performed</span>
<span class="sd">        False: Not performed</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">        ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : current position</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_current_positions</span><span class="p">()</span>
    <span class="n">current_real_position</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span><span class="p">[</span><span class="s1">&#39;PositionReal&#39;</span><span class="p">]</span>
    <span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">,</span> <span class="n">z_current</span> <span class="o">=</span> <span class="n">current_real_position</span>

    <span class="k">if</span> <span class="n">safety_test</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>  
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_z</span><span class="p">(</span><span class="n">position_z</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;safety test of move has yet to be implemented&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">x_current</span><span class="p">,</span> <span class="n">y_current</span><span class="p">):</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">move_z</span><span class="p">(</span><span class="n">position_z</span><span class="p">)</span>


    <span class="c1"># WAIT FOR MOVEMENT TO BE DONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">busy_wait</span><span class="p">(</span><span class="mi">25</span><span class="p">)</span>

    <span class="c1"># r = self.client.get_current_positions()</span>
    <span class="c1"># new_real_position = r.RESULTS[&#39;PositionReal&#39;]</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_forbidden_region" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_forbidden_region</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">,</span> <span class="n">rotation_state</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>set a forbidden region in the robot coordinate x y plane for end-point testing 
defined via a rectangle in the x-y-plane. x_start&lt;x_stop, y_start&lt;y_stop
set the region depending on the rotation state, as some regions are forbidden only in one configuration</p>
<p>Parameters
x_start : float
    x-position start 
x_stop : float
    x-position stop
y_start : float
    y-position start 
y_stop : float
    y-position stop
rotation_state: string
    options are "horizontal" (nozzle sideways, base 90 degrees), "vertical" (nozzle vertical, base 0 degree), "both"</p>
<hr />

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_forbidden_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span><span class="p">,</span> <span class="n">rotation_state</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    set a forbidden region in the robot coordinate x y plane for end-point testing </span>
<span class="sd">    defined via a rectangle in the x-y-plane. x_start&lt;x_stop, y_start&lt;y_stop</span>
<span class="sd">    set the region depending on the rotation state, as some regions are forbidden only in one configuration</span>

<span class="sd">    Parameters</span>
<span class="sd">    x_start : float</span>
<span class="sd">        x-position start </span>
<span class="sd">    x_stop : float</span>
<span class="sd">        x-position stop</span>
<span class="sd">    y_start : float</span>
<span class="sd">        y-position start </span>
<span class="sd">    y_stop : float</span>
<span class="sd">        y-position stop</span>
<span class="sd">    rotation_state: string</span>
<span class="sd">        options are &quot;horizontal&quot; (nozzle sideways, base 90 degrees), &quot;vertical&quot; (nozzle vertical, base 0 degree), &quot;both&quot;</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">region_tuple</span> <span class="o">=</span> <span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_stop</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span><span class="n">x_stop</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_start</span><span class="p">,</span><span class="n">y_stop</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">y_start</span><span class="p">,</span><span class="n">y_stop</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;vertical&quot;</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">rotation_state</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">region_tuple</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;invalid input of rotation state&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_nozzle_dispensing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_nozzle_dispensing</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;Off&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Sets the dispensing, either "Free", "Triggered", or "Off"
Parameters
mode : string 
    either "free", "triggered", or "off"
verbose : boolean
        Defines whether the function returns the full output, or only the results</p>
<hr />
<p>Returns: 
r :</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_nozzle_dispensing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;Off&quot;</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Sets the dispensing, either &quot;Free&quot;, &quot;Triggered&quot;, or &quot;Off&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    mode : string </span>
<span class="sd">        either &quot;free&quot;, &quot;triggered&quot;, or &quot;off&quot;</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">            Defines whether the function returns the full output, or only the results</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Free&#39;</span><span class="p">:</span> 
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Free&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;Triggered&#39;</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Triggered&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="c1">#turns active nozzles off. Safer if all nozzles would be turned off</span>
        <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]:</span> 
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">select_nozzle</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">dispensing</span><span class="p">(</span><span class="s1">&#39;Off&#39;</span><span class="p">)</span>

    <span class="n">rr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span><span class="o">.</span><span class="n">RESULTS</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_timing_abs_Xray" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_timing_abs_Xray</span><span class="p">(</span><span class="n">timing_abs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setting the absolute timing of the X-rays for claculation purposes</p>
<p>Parameters
timing_abs : float
    abs timing in ns from robot alignment</p>
<hr />
<p>Returns:</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_timing_abs_Xray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing_abs</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setting the absolute timing of the X-rays for claculation purposes</span>

<span class="sd">    Parameters</span>
<span class="sd">    timing_abs : float</span>
<span class="sd">        abs timing in ns from robot alignment</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">=</span> <span class="n">timing_abs</span> <span class="c1">#delay of LED relative to X-ray timing</span>
    <span class="c1">#self.trigger_Xray.ns_delay.put(self.timing_Xray)</span>

    <span class="c1"># update timings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_timing_rel_LED" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_timing_rel_LED</span><span class="p">(</span><span class="n">timing_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setting the relative timing of the LED relative to the X-rays</p>
<p>Parameters
timing_rel : float
    relative delay in ns from robot alignment</p>
<hr />
<p>Returns:</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_timing_rel_LED</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setting the relative timing of the LED relative to the X-rays</span>

<span class="sd">    Parameters</span>
<span class="sd">    timing_rel : float</span>
<span class="sd">        relative delay in ns from robot alignment</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span> <span class="o">=</span> <span class="n">timing_rel</span> <span class="c1">#delay of LED relative to X-ray timing</span>

    <span class="c1"># update timings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_timing_rel_reaction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_timing_rel_reaction</span><span class="p">(</span><span class="n">timing_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setting the relative timing of the reaction relative to the X-rays</p>
<p>Parameters
timing_rel : float
    relative delay in ns from robot alignment</p>
<hr />
<p>Returns:</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_timing_rel_reaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setting the relative timing of the reaction relative to the X-rays</span>

<span class="sd">    Parameters</span>
<span class="sd">    timing_rel : float</span>
<span class="sd">        relative delay in ns from robot alignment</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span> <span class="o">=</span> <span class="n">timing_rel</span> <span class="c1">#delay of LED relative to X-ray timing</span>

    <span class="c1"># update timings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_timing_relative_nozzle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_timing_relative_nozzle</span><span class="p">(</span><span class="n">nozzle</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Changing the timing of the selected nozzle by a relative amount </p>
<p>Parameters
nozle : int
    nozzle number
timing_rel : float
    relative change in ns from robot alignment</p>
<hr />
<p>Returns:</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_timing_relative_nozzle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nozzle</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Changing the timing of the selected nozzle by a relative amount </span>

<span class="sd">    Parameters</span>
<span class="sd">    nozle : int</span>
<span class="sd">        nozzle number</span>
<span class="sd">    timing_rel : float</span>
<span class="sd">        relative change in ns from robot alignment</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
        <span class="n">current_timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">+</span> <span class="n">timing_rel</span>
    <span class="k">elif</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> 
        <span class="n">current_timing</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">+</span> <span class="n">timing_rel</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no valid nozzle selected.&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># update timings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_timing_update" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_timing_update</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>updating the timing triggers according to the set relative and absolute timing values</p>
<p>Parameters
       ----------
Returns:</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_timing_update</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    updating the timing triggers according to the set relative and absolute timing values</span>

<span class="sd">    Parameters</span>
<span class="sd">           ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Nozzle 1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="o">*</span><span class="mi">1000000000</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_1</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_1</span><span class="p">)</span>

    <span class="c1"># Nozzle 2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_sciPulse</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_reaction</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">120</span><span class="o">*</span><span class="mi">1000000000</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trigger_nozzle_2</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_nozzle_2</span><span class="p">)</span>

    <span class="c1"># LED</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_Xray</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_LED</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">trigger_LED</span><span class="o">.</span><span class="n">ns_delay</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timing_LED</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.set_timing_zero_nozzle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_timing_zero_nozzle</span><span class="p">(</span><span class="n">nozzle</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Setting the time zero for the nozzles from the LED alignment in robot</p>
<p>Parameters
nozle : int
    nozzle number
timing_rel : float
    relative delay in ns from robot alignment</p>
<hr />
<p>Returns:</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_timing_zero_nozzle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nozzle</span><span class="p">,</span> <span class="n">timing_rel</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setting the time zero for the nozzles from the LED alignment in robot</span>

<span class="sd">    Parameters</span>
<span class="sd">    nozle : int</span>
<span class="sd">        nozzle number</span>
<span class="sd">    timing_rel : float</span>
<span class="sd">        relative delay in ns from robot alignment</span>
<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_1</span> <span class="o">=</span> <span class="n">timing_rel</span>
    <span class="k">elif</span> <span class="n">nozzle</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">timing_delay_nozzle_2</span> <span class="o">=</span> <span class="n">timing_rel</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;no valid nozzle selected.&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="c1"># update timings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_timing_update</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.stop_task" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stop_task</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Stop task while running
** ISSUES **
-  When stop task  is called, the Robot stays in "BUSY" Status.
Parameters</p>
<hr />
<p>verbose : boolean
    Defines whether the function returns the full output, or only the results
Returns: 
r : 
    status readback when aborted</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stop_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Stop task while running</span>
<span class="sd">    ** ISSUES **</span>
<span class="sd">    -  When stop task  is called, the Robot stays in &quot;BUSY&quot; Status.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    verbose : boolean</span>
<span class="sd">        Defines whether the function returns the full output, or only the results</span>
<span class="sd">    Returns: </span>
<span class="sd">    r : </span>
<span class="sd">        status readback when aborted</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;Test&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">safety_abort</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">stop_task</span><span class="p">()</span>
    <span class="n">r</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">verbose</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span> 
        <span class="k">return</span> <span class="n">r</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.DoD.test_forbidden_region" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">test_forbidden_region</span><span class="p">(</span><span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>tests if the end point of a motion is inside a forbidden region
No testing of the path of a motion included!</p>
<p>Parameters
x_test : float
    x-position to test 
y_test : float 
    y-position to test </p>
<hr />
<p>Returns: 
safe_motion : bool
    boolean flag if endpoint of motion is safe or not</p>

            <details class="quote">
              <summary>Source code in <code>dod/dod.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">test_forbidden_region</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">):</span> 
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    tests if the end point of a motion is inside a forbidden region</span>
<span class="sd">    No testing of the path of a motion included!</span>

<span class="sd">    Parameters</span>
<span class="sd">    x_test : float</span>
<span class="sd">        x-position to test </span>
<span class="sd">    y_test : float </span>
<span class="sd">        y-position to test </span>

<span class="sd">    ----------</span>
<span class="sd">    Returns: </span>
<span class="sd">    safe_motion : bool</span>
<span class="sd">        boolean flag if endpoint of motion is safe or not</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">dod.codi</span><span class="w"> </span><span class="kn">import</span> <span class="n">CoDI_base</span>
    <span class="c1"># Get current rotation state</span>
    <span class="n">pos_rot_base</span>  <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">CoDI_base</span><span class="o">.</span><span class="n">wm</span><span class="p">(),</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1">#Initialize safe flag (True = safe)</span>
    <span class="n">flag_safe_endpoint</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1">#combine the lists depending on the rotation </span>
    <span class="k">if</span> <span class="n">pos_rot_base</span> <span class="o">==</span> <span class="mi">90</span><span class="p">:</span> 
        <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>
    <span class="k">elif</span> <span class="n">pos_rot_base</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test_list_safety</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_horizontal</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">forbidden_regions_vertical</span>

    <span class="c1">#Test for all regions if the end point is in the forbidden region</span>
    <span class="k">for</span> <span class="n">tuple_current</span> <span class="ow">in</span> <span class="n">test_list_safety</span><span class="p">:</span> 
        <span class="n">x_start</span><span class="p">,</span> <span class="n">x_stop</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_stop</span> <span class="o">=</span> <span class="n">tuple_current</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">x_start</span> <span class="o">&lt;</span> <span class="n">x_test</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">x_stop</span> <span class="o">&gt;</span> <span class="n">x_test</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y_start</span> <span class="o">&lt;</span> <span class="n">y_test</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">y_stop</span> <span class="o">&gt;</span> <span class="n">y_test</span><span class="p">)):</span> 
            <span class="n">flag_safe_endpoint</span> <span class="o">=</span> <span class="n">flag_safe_endpoint</span> <span class="ow">and</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flag_safe_endpoint</span> <span class="o">=</span> <span class="n">flag_safe_endpoint</span> <span class="ow">and</span> <span class="kc">True</span>

    <span class="k">return</span> <span class="n">flag_safe_endpoint</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mfx.beamline.MFX_Timing" class="doc doc-heading">
            <code>MFX_Timing</code>


</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>mfx/mfx_timing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">MFX_Timing</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">sequencer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">pcdsdevices.sequencer</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventSequencer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq1</span> <span class="o">=</span> <span class="n">EventSequencer</span><span class="p">(</span><span class="s1">&#39;ECS:SYS0:7&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mfx_sequencer&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq2</span> <span class="o">=</span> <span class="n">EventSequencer</span><span class="p">(</span><span class="s1">&#39;ECS:SYS0:12&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;mfx_sequencer_spare&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">evt_code</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;wait&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span>
            <span class="s1">&#39;pp_trig&#39;</span><span class="p">:</span><span class="mi">197</span><span class="p">,</span>
            <span class="s1">&#39;daq_readout&#39;</span><span class="p">:</span><span class="mi">198</span><span class="p">,</span>
            <span class="s1">&#39;laser_on&#39;</span><span class="p">:</span><span class="mi">203</span><span class="p">,</span>
            <span class="s1">&#39;laser_off&#39;</span><span class="p">:</span><span class="mi">204</span><span class="p">,</span>
            <span class="s1">&#39;ray_readout&#39;</span><span class="p">:</span><span class="mi">210</span><span class="p">,</span>
            <span class="s1">&#39;ray1&#39;</span><span class="p">:</span><span class="mi">211</span><span class="p">,</span>
            <span class="s1">&#39;ray2&#39;</span><span class="p">:</span><span class="mi">212</span><span class="p">,</span>
            <span class="s1">&#39;ray3&#39;</span><span class="p">:</span><span class="mi">213</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sync_markers</span> <span class="o">=</span> <span class="p">{</span><span class="mf">0.5</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="mi">60</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="mi">120</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span> <span class="mi">360</span><span class="p">:</span><span class="mi">7</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="p">[]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt_code_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">delta_beam</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">evt_code</span><span class="p">[</span><span class="n">evt_code_name</span><span class="p">],</span> <span class="n">delta_beam</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error: event sequencer step not recognized.&#39;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sync_mark</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">sync_marker</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sync_markers</span><span class="p">[</span><span class="n">sync_mark</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sequence</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">15</span><span class="p">):</span>
            <span class="n">sequence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_step</span><span class="p">(</span><span class="s1">&#39;wait&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">put_seq</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
        <span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">steps</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_step</span><span class="p">(</span><span class="n">step</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">step</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">sequence</span><span class="o">.</span><span class="n">put_seq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_120hz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ray_readout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray2&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray3&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">steps</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_120hz_trucated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ray_readout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">steps</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_60hz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ray_readout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;pp_trig&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;pp_trig&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">steps</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_60hz_trucated</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ray_readout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">steps</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_30hz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ray_readout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;pp_trig&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">steps</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">_seq_20hz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">steps</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ray_readout&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;pp_trig&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray2&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;daq_readout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                 <span class="p">[</span><span class="s1">&#39;ray3&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">steps</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">set_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequencer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">laser</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set your event sequencer</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    rep: int, optional</span>
<span class="sd">        Set repitition rate only 120, 60, 30, and 20 Hz are currently available</span>

<span class="sd">    sequencer: str, optional</span>
<span class="sd">        default is event sequencer 7 and use &#39;spare&#39; to run sequencer 12</span>

<span class="sd">    laser: list, optional</span>
<span class="sd">        sets laser sequence list in format [[&#39;laser_on&#39;,0],[&#39;laser_off&#39;,0],...]</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq1</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq2</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">sequencer</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;spare&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq1</span>
        <span class="k">if</span> <span class="n">laser</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">120</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                    <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_120hz_trucated</span><span class="p">()</span>
                    <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                    <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_60hz_trucated</span><span class="p">()</span>
                    <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                    <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_30hz</span><span class="p">()</span>
                    <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                    <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_20hz</span><span class="p">()</span>
                    <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                    <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">120</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_120hz</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_60hz</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_30hz</span><span class="p">())</span>
            <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_20hz</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.MFX_Timing.set_seq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">set_seq</span><span class="p">(</span><span class="n">rep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequencer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">laser</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Set your event sequencer</p>
<h5 id="mfx.beamline.MFX_Timing.set_seq--parameters">Parameters</h5>
<p>rep: int, optional
    Set repitition rate only 120, 60, 30, and 20 Hz are currently available</p>


<details class="sequencer" open>
  <summary>str, optional</summary>
  <p>default is event sequencer 7 and use 'spare' to run sequencer 12</p>
</details>

<details class="laser" open>
  <summary>list, optional</summary>
  <p>sets laser sequence list in format [['laser_on',0],['laser_off',0],...]</p>
</details>        <h5 id="mfx.beamline.MFX_Timing.set_seq--operations">Operations</h5>

            <details class="quote">
              <summary>Source code in <code>mfx/mfx_timing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_seq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">sequencer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">laser</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Set your event sequencer</span>

<span class="sd">Parameters</span>
<span class="sd">----------</span>
<span class="sd">rep: int, optional</span>
<span class="sd">    Set repitition rate only 120, 60, 30, and 20 Hz are currently available</span>

<span class="sd">sequencer: str, optional</span>
<span class="sd">    default is event sequencer 7 and use &#39;spare&#39; to run sequencer 12</span>

<span class="sd">laser: list, optional</span>
<span class="sd">    sets laser sequence list in format [[&#39;laser_on&#39;,0],[&#39;laser_off&#39;,0],...]</span>

<span class="sd">Operations</span>
<span class="sd">----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seq1</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">seq2</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">sequencer</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;spare&#39;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq1</span>
    <span class="k">if</span> <span class="n">laser</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">120</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_120hz_trucated</span><span class="p">()</span>
                <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_60hz_trucated</span><span class="p">()</span>
                <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_30hz</span><span class="p">()</span>
                <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">laser_evt</span> <span class="ow">in</span> <span class="n">laser</span><span class="p">:</span>
                <span class="n">sequence</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_seq_20hz</span><span class="p">()</span>
                <span class="n">block</span> <span class="o">=</span> <span class="n">sequence</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">laser_evt</span><span class="p">)</span>
                <span class="n">block</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sequence</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">rep</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">120</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_120hz</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_60hz</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">30</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_30hz</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">rep</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_init</span><span class="p">(</span><span class="n">sync_mark</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_seq_put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_seq_20hz</span><span class="p">())</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="mfx.beamline.OM" class="doc doc-heading">
            <code>OM</code>


</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>mfx/om.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">OM</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.macros</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_exp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">experiment</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_exp</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;/cds/home/opr/mfxopr/OM-GUI&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pwd</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s1">&#39;</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">fix_run_om</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fixes the run_om.sh file to have current experiment number</span>

<span class="sd">        Parameters:</span>
<span class="sd">            path (str): run_om.sh file path.</span>

<span class="sd">        Operations:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">subprocess</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_output</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating run_om.sh file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">wherepsana</span> <span class="o">=</span> <span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;wherepsana&quot;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;--host&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                    <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;     --host </span><span class="si">{</span><span class="n">wherepsana</span><span class="si">}</span><span class="s1"> $(pwd)/monitor_wrapper.sh</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">fix_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yaml</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fixes the yaml file to have current experiment number</span>

<span class="sd">        Parameters:</span>
<span class="sd">            yaml (str): monitor.yaml file path.</span>

<span class="sd">            mask (str): mask file path.</span>

<span class="sd">            geom (str): geom file path.</span>

<span class="sd">        Operations:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating yaml file: </span><span class="si">{</span><span class="n">yaml</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;psana_calibration_directory&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                    <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;  psana_calibration_directory: /sdf/data/lcls/ds/mfx/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s1">/calib</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>
            <span class="k">if</span> <span class="n">mask</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s1">&#39;bad_pixel_map_filename&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                        <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;  bad_pixel_map_filename: </span><span class="si">{</span><span class="n">mask</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>

            <span class="k">if</span> <span class="n">geom</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                    <span class="k">if</span> <span class="s1">&#39;geometry_file&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                        <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;  geometry_file: </span><span class="si">{</span><span class="n">geom</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">check_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks OM&#39;s file system and sets it up if needed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        Operations</span>
<span class="sd">        ----------</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">shutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy2</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checking OM Files&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No Directory Exists for Experiment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s2">. Would you like to create it?&quot;</span><span class="p">)</span>
            <span class="n">mkdir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;(y/n)? &quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">mkdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directory for Experiment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
                <span class="n">pre_pwd</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span> <span class="n">d</span><span class="p">))],</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>

                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span>
                <span class="n">det_dirs</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_rayonix&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_xes&#39;</span><span class="p">]</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directories for Epix10k2M.&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directories for Rayonix.&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directories for XES.&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="n">pre_det_dirs</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s1">/om_workspace&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s1">/om_workspace_rayonix&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s1">/om_workspace_xes&#39;</span><span class="p">]</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying Key Files from Previous Experiment: </span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">det</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">):</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying Key Files for: </span><span class="si">{</span><span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">shell_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.sh&quot;</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shell_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">shell_list</span><span class="p">:</span>
                            <span class="n">copy2</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No shell scripts found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="s1">&#39;run_om.sh&#39;</span><span class="p">)):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fix_run_om</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="s1">&#39;run_om.sh&#39;</span><span class="p">))</span>

                    <span class="n">geom_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                            <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geom&quot;</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geom_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">geom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">geom_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>
                        <span class="n">copy2</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No geom found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="n">mask_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                            <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;mask&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mask_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">mask</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mask_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>
                        <span class="n">copy2</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No mask found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                    <span class="n">yaml_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                            <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">yaml_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">yaml</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yaml_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>
                        <span class="n">copy2</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fix_yaml</span><span class="p">(</span>
                            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                                <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">yaml</span><span class="p">)),</span> <span class="n">mask</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span> <span class="n">geom</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">geom</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No yaml found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying om_reset_plots.py&quot;</span><span class="p">)</span>
                <span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_pwd</span><span class="p">,</span> <span class="s1">&#39;om_reset_plots.py&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided not to continue. Program will exit&quot;</span><span class="p">)</span>
                <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">gui</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">facility</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;S3DF&quot;</span><span class="p">,</span>
        <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launch OM GUI.</span>

<span class="sd">        Parameters:</span>

<span class="sd">            user (str): username for computer account at facility.</span>

<span class="sd">            facility (str): Default: &quot;S3DF&quot;. Options: &quot;S3DF, NERSC&quot;.</span>

<span class="sd">            debug (bool): Default: False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

        <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s2">&quot;ssh -YAC </span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">@s3dflogin &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;/sdf/group/lcls/ds/tools/mfx/scripts/unknown &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">facility</span><span class="si">}</span><span class="s2"> 1 </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">]</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">proc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">kill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

        <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;ssh -YAC mfx-monitor &quot;</span>
            <span class="s2">&quot;kill -9  `ps ux | grep monitor_wrapper.sh | grep -v grep | awk &#39;{ print $2 }&#39;`&quot;</span>
            <span class="p">]</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">om</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">calibdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Launches OM</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        det: str, optional</span>
<span class="sd">            Detector name. Example &#39;Rayonix&#39;, &#39;Epix10k2M&#39;, or &#39;XES&#39; for spectroscopy</span>

<span class="sd">        start: str, optional</span>
<span class="sd">            Which process to start. All by default</span>

<span class="sd">        calibdir: str, optional</span>
<span class="sd">            path to calib directory</span>

<span class="sd">        debug (bool): Default: False.</span>

<span class="sd">        Operations</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">check_settings</span><span class="p">()</span>
        <span class="n">monitor_wrapper</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">monitor_wrapper</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
            <span class="s2">&quot;ssh -YAC mfx-monitor ps aux | grep monitor_wrapper.sh | grep -v grep | awk &#39;{ print $2 }&#39;&quot;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

        <span class="n">det_dir</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;rayonix&#39;</span><span class="p">:</span>
                <span class="n">det_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_rayonix&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;epix10k2m&#39;</span><span class="p">:</span>
                <span class="n">det_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;xes&#39;</span><span class="p">:</span>
                <span class="n">det_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_xes&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
                <span class="s2">&quot;No proper detector seclected. Please use either&quot;</span>
                <span class="s2">&quot;&#39;Rayonix&#39;, &#39;Epix10k2M&#39;, or &#39;XES&#39; for spectroscopy&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">monitor_wrapper</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_gui.sh&#39;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_frame_viewer.sh&#39;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">&#39;ssh -YAC mfx-monitor &quot;cd </span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">; ./run_om.sh&quot;&#39;</span>
                <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_gui.sh&#39;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_frame_viewer.sh&#39;</span>
                <span class="p">]</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="n">proc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="n">proc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">proc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">proc</span><span class="p">:</span>
                <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                    <span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                    <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resets OM</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        Operations</span>
<span class="sd">        ----------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

        <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;ssh -YAC mfx-monitor &quot;source /reg/g/pcds/engineering_tools/mfx/scripts/pcds_conda; &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;conda deactivate; source /cds/sw/ds/ana/conda1/manage/bin/psconda.sh; &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_reset_plots.py daq-mfx-mon10&quot;&#39;</span><span class="p">,</span>
            <span class="p">]</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.OM.check_settings" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_settings</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Checks OM's file system and sets it up if needed</p>
<h5 id="mfx.beamline.OM.check_settings--parameters">Parameters</h5>
<h5 id="mfx.beamline.OM.check_settings--operations">Operations</h5>

            <details class="quote">
              <summary>Source code in <code>mfx/om.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_settings</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks OM&#39;s file system and sets it up if needed</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">shutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">copy2</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Checking OM Files&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No Directory Exists for Experiment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s2">. Would you like to create it?&quot;</span><span class="p">)</span>
        <span class="n">mkdir</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;(y/n)? &quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">mkdir</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directory for Experiment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="n">pre_pwd</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span>
                <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cwd</span><span class="p">,</span> <span class="n">d</span><span class="p">))],</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>

            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span>
            <span class="n">det_dirs</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_rayonix&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_xes&#39;</span><span class="p">]</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directories for Epix10k2M.&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directories for Rayonix.&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Creating Directories for XES.&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

            <span class="n">pre_det_dirs</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s1">/om_workspace&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s1">/om_workspace_rayonix&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s1">/om_workspace_xes&#39;</span><span class="p">]</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying Key Files from Previous Experiment: </span><span class="si">{</span><span class="n">pre_pwd</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">det</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">det_dirs</span><span class="p">):</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying Key Files for: </span><span class="si">{</span><span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">shell_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                    <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.sh&quot;</span><span class="p">)]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">shell_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">sh</span> <span class="ow">in</span> <span class="n">shell_list</span><span class="p">:</span>
                        <span class="n">copy2</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No shell scripts found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="s1">&#39;run_om.sh&#39;</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fix_run_om</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">det</span><span class="p">,</span> <span class="s1">&#39;run_om.sh&#39;</span><span class="p">))</span>

                <span class="n">geom_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.geom&quot;</span><span class="p">)]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">geom_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">geom</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">geom_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>
                    <span class="n">copy2</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No geom found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">mask_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="s1">&#39;mask&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mask_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">mask</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mask_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>
                    <span class="n">copy2</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No mask found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="n">yaml_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span>
                        <span class="n">pre_det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span> <span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.yaml&quot;</span><span class="p">)]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">yaml_list</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">yaml</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">yaml_list</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">)</span>
                    <span class="n">copy2</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fix_yaml</span><span class="p">(</span>
                        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="n">det_dirs</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">yaml</span><span class="p">)),</span> <span class="n">mask</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">mask</span><span class="p">),</span> <span class="n">geom</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">geom</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No yaml found in: </span><span class="si">{</span><span class="n">det</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Copying om_reset_plots.py&quot;</span><span class="p">)</span>
            <span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pre_pwd</span><span class="p">,</span> <span class="s1">&#39;om_reset_plots.py&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;You&#39;ve decided not to continue. Program will exit&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.OM.fix_run_om" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fix_run_om</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fixes the run_om.sh file to have current experiment number</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>run_om.sh file path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Operations:</p>

            <details class="quote">
              <summary>Source code in <code>mfx/om.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fix_run_om</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fixes the run_om.sh file to have current experiment number</span>

<span class="sd">    Parameters:</span>
<span class="sd">        path (str): run_om.sh file path.</span>

<span class="sd">    Operations:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">subprocess</span><span class="w"> </span><span class="kn">import</span> <span class="n">check_output</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating run_om.sh file: </span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">wherepsana</span> <span class="o">=</span> <span class="n">check_output</span><span class="p">(</span><span class="s2">&quot;wherepsana&quot;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;--host&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;     --host </span><span class="si">{</span><span class="n">wherepsana</span><span class="si">}</span><span class="s1"> $(pwd)/monitor_wrapper.sh</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.OM.fix_yaml" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fix_yaml</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Fixes the yaml file to have current experiment number</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>yaml</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>monitor.yaml file path.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>mask file path.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>geom</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>geom file path.</p>
              </div>
            </td>
            <td>
                  <code>&#39;&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Operations:</p>

            <details class="quote">
              <summary>Source code in <code>mfx/om.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fix_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">yaml</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">geom</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fixes the yaml file to have current experiment number</span>

<span class="sd">    Parameters:</span>
<span class="sd">        yaml (str): monitor.yaml file path.</span>

<span class="sd">        mask (str): mask file path.</span>

<span class="sd">        geom (str): geom file path.</span>

<span class="sd">    Operations:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Updating yaml file: </span><span class="si">{</span><span class="n">yaml</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;psana_calibration_directory&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;  psana_calibration_directory: /sdf/data/lcls/ds/mfx/</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s1">/calib</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>
        <span class="k">if</span> <span class="n">mask</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;bad_pixel_map_filename&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                    <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;  bad_pixel_map_filename: </span><span class="si">{</span><span class="n">mask</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>

        <span class="k">if</span> <span class="n">geom</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;geometry_file&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
                    <span class="n">newline</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;  geometry_file: </span><span class="si">{</span><span class="n">geom</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Changing line </span><span class="si">{</span><span class="n">ind</span><span class="si">}</span><span class="s1"> to </span><span class="si">{</span><span class="n">newline</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">lines</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">newline</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">yaml</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">file</span><span class="o">.</span><span class="n">writelines</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.OM.gui" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gui</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">facility</span><span class="o">=</span><span class="s1">&#39;S3DF&#39;</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Launch OM GUI.</p>
<p>Parameters:</p>
<pre><code>user (str): username for computer account at facility.

facility (str): Default: "S3DF". Options: "S3DF, NERSC".

debug (bool): Default: False.
</code></pre>

            <details class="quote">
              <summary>Source code in <code>mfx/om.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gui</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">user</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">facility</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;S3DF&quot;</span><span class="p">,</span>
    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Launch OM GUI.</span>

<span class="sd">    Parameters:</span>

<span class="sd">        user (str): username for computer account at facility.</span>

<span class="sd">        facility (str): Default: &quot;S3DF&quot;. Options: &quot;S3DF, NERSC&quot;.</span>

<span class="sd">        debug (bool): Default: False.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

    <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;ssh -YAC </span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">@s3dflogin &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;/sdf/group/lcls/ds/tools/mfx/scripts/unknown &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">experiment</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">facility</span><span class="si">}</span><span class="s2"> 1 </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">]</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">proc</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.OM.om" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">om</span><span class="p">(</span><span class="n">det</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">calibdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Launches OM</p>
<h5 id="mfx.beamline.OM.om--parameters">Parameters</h5>
<p>det: str, optional
    Detector name. Example 'Rayonix', 'Epix10k2M', or 'XES' for spectroscopy</p>


<details class="start" open>
  <summary>str, optional</summary>
  <p>Which process to start. All by default</p>
</details>

<details class="calibdir" open>
  <summary>str, optional</summary>
  <p>path to calib directory</p>
</details>        <p>debug (bool): Default: False.</p>
<h5 id="mfx.beamline.OM.om--operations">Operations</h5>

            <details class="quote">
              <summary>Source code in <code>mfx/om.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">om</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">calibdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Launches OM</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    det: str, optional</span>
<span class="sd">        Detector name. Example &#39;Rayonix&#39;, &#39;Epix10k2M&#39;, or &#39;XES&#39; for spectroscopy</span>

<span class="sd">    start: str, optional</span>
<span class="sd">        Which process to start. All by default</span>

<span class="sd">    calibdir: str, optional</span>
<span class="sd">        path to calib directory</span>

<span class="sd">    debug (bool): Default: False.</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">check_settings</span><span class="p">()</span>
    <span class="n">monitor_wrapper</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">monitor_wrapper</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
        <span class="s2">&quot;ssh -YAC mfx-monitor ps aux | grep monitor_wrapper.sh | grep -v grep | awk &#39;{ print $2 }&#39;&quot;</span><span class="p">,</span><span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>

    <span class="n">det_dir</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;rayonix&#39;</span><span class="p">:</span>
            <span class="n">det_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_rayonix&#39;</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;epix10k2m&#39;</span><span class="p">:</span>
            <span class="n">det_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace&#39;</span>
    <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;xes&#39;</span><span class="p">:</span>
            <span class="n">det_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_workspace_xes&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span>
            <span class="s2">&quot;No proper detector seclected. Please use either&quot;</span>
            <span class="s2">&quot;&#39;Rayonix&#39;, &#39;Epix10k2M&#39;, or &#39;XES&#39; for spectroscopy&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">monitor_wrapper</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_gui.sh&#39;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_frame_viewer.sh&#39;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;ssh -YAC mfx-monitor &quot;cd </span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">; ./run_om.sh&quot;&#39;</span>
            <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_gui.sh&#39;</span><span class="p">,</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">det_dir</span><span class="si">}</span><span class="s1">/run_frame_viewer.sh&#39;</span>
            <span class="p">]</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">proc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="n">proc</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">proc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">proc</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="n">cmd</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
                <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="mfx.beamline.OM.reset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Resets OM</p>
<h5 id="mfx.beamline.OM.reset--parameters">Parameters</h5>
<h5 id="mfx.beamline.OM.reset--operations">Operations</h5>

            <details class="quote">
              <summary>Source code in <code>mfx/om.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Resets OM</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

    <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s1">&#39;ssh -YAC mfx-monitor &quot;source /reg/g/pcds/engineering_tools/mfx/scripts/pcds_conda; &#39;</span>
        <span class="sa">f</span><span class="s1">&#39;conda deactivate; source /cds/sw/ds/ana/conda1/manage/bin/psconda.sh; &#39;</span>
        <span class="sa">f</span><span class="s1">&#39;python </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">pwd</span><span class="si">}</span><span class="s1">/om_reset_plots.py daq-mfx-mon10&quot;&#39;</span><span class="p">,</span>
        <span class="p">]</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

    <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.attenuator_scan_separate_runs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">attenuator_scan_separate_runs</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transmissions</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span> <span class="n">use_daq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Runs through attenuator conditions and records each as an individual run</p>
<h4 id="mfx.beamline.attenuator_scan_separate_runs--parameters">Parameters</h4>
<p>duration: int, optional
    When using the DAQ this corresponds to the number of events. If not
    using the DAQ, it corresponds to the number of seconds to wait at ech
    attenuator step. Default is 240 events (with DAQ), or 3 seconds (no DAQ).</p>


<details class="record" open>
  <summary>bool, optional</summary>
  <p>set True to record</p>
</details>

<details class="transmissions" open>
  <summary>list of floats, optional</summary>
  <p>list of transmissions to run through. default [0.01,0.02,0.03]</p>
</details>

<details class="use_daq" open>
  <summary>bool, optional</summary>
  <p>Whether to include the DAQ or not. Default: True. If False can run the
scans while using the DAQ elsewhere.</p>
</details>        <p>**kwargs - Additional optional keyword arguments
    events: int
        Provided for backwards compatibility. When using the DAQ, if this
        keyword argument is passed, and <code>duration</code> is not, it will be used
        as the number of events.</p>
<h4 id="mfx.beamline.attenuator_scan_separate_runs--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/attenuator_scan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">attenuator_scan_separate_runs</span><span class="p">(</span>
    <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">record</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">transmissions</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span>
    <span class="n">use_daq</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs through attenuator conditions and records each as an individual run</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    duration: int, optional</span>
<span class="sd">        When using the DAQ this corresponds to the number of events. If not</span>
<span class="sd">        using the DAQ, it corresponds to the number of seconds to wait at ech</span>
<span class="sd">        attenuator step. Default is 240 events (with DAQ), or 3 seconds (no DAQ).</span>

<span class="sd">    record: bool, optional</span>
<span class="sd">        set True to record</span>

<span class="sd">    transmissions: list of floats, optional</span>
<span class="sd">        list of transmissions to run through. default [0.01,0.02,0.03]</span>

<span class="sd">    use_daq: bool, optional</span>
<span class="sd">        Whether to include the DAQ or not. Default: True. If False can run the</span>
<span class="sd">        scans while using the DAQ elsewhere.</span>

<span class="sd">    **kwargs - Additional optional keyword arguments</span>
<span class="sd">        events: int</span>
<span class="sd">            Provided for backwards compatibility. When using the DAQ, if this</span>
<span class="sd">            keyword argument is passed, and `duration` is not, it will be used</span>
<span class="sd">            as the number of events.</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">att</span><span class="p">,</span> <span class="n">pp</span>

    <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">daq</span>

    <span class="n">evts</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">evts</span> <span class="k">if</span> <span class="n">evts</span> <span class="k">else</span> <span class="mi">240</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">if</span> <span class="n">evts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;`events` parameter ignored when not using DAQ! Use `duration`!&quot;</span><span class="p">)</span>

    <span class="n">pp</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">transmissions</span><span class="p">:</span>
        <span class="n">att</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">record</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">end_run</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sleep</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="n">pp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
        <span class="n">daq</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.attenuator_scan_single_run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">attenuator_scan_single_run</span><span class="p">(</span><span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transmissions</span><span class="o">=</span><span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span> <span class="n">use_daq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Runs through attenuator conditions and records them all as one continuous run</p>
<h4 id="mfx.beamline.attenuator_scan_single_run--parameters">Parameters</h4>
<p>duration: int, optional
    When using the DAQ this corresponds to the number of events. If not
    using the DAQ, it corresponds to the number of seconds to wait at ech
    attenuator step. Default is 240 events (with DAQ), or 3 seconds (no DAQ).</p>


<details class="record" open>
  <summary>bool, optional</summary>
  <p>set True to record</p>
</details>

<details class="transmissions" open>
  <summary>list of floats, optional</summary>
  <p>list of transmissions to run through. default [0.01,0.02,0.03]</p>
</details>

<details class="use_daq" open>
  <summary>bool, optional</summary>
  <p>Whether to include the DAQ or not. Default: True. If False can run the
scans while using the DAQ elsewhere.</p>
</details>        <p>**kwargs - Additional optional keyword arguments
    events: int
        Provided for backwards compatibility. When using the DAQ, if this
        keyword argument is passed, and <code>duration</code> is not, it will be used
        as the number of events. It is ignored when not using the DAQ.</p>
<h4 id="mfx.beamline.attenuator_scan_single_run--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/attenuator_scan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">attenuator_scan_single_run</span><span class="p">(</span>
    <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">record</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">transmissions</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">],</span>
    <span class="n">use_daq</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs through attenuator conditions and records them all as one continuous run</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    duration: int, optional</span>
<span class="sd">        When using the DAQ this corresponds to the number of events. If not</span>
<span class="sd">        using the DAQ, it corresponds to the number of seconds to wait at ech</span>
<span class="sd">        attenuator step. Default is 240 events (with DAQ), or 3 seconds (no DAQ).</span>

<span class="sd">    record: bool, optional</span>
<span class="sd">        set True to record</span>

<span class="sd">    transmissions: list of floats, optional</span>
<span class="sd">        list of transmissions to run through. default [0.01,0.02,0.03]</span>

<span class="sd">    use_daq: bool, optional</span>
<span class="sd">        Whether to include the DAQ or not. Default: True. If False can run the</span>
<span class="sd">        scans while using the DAQ elsewhere.</span>

<span class="sd">    **kwargs - Additional optional keyword arguments</span>
<span class="sd">        events: int</span>
<span class="sd">            Provided for backwards compatibility. When using the DAQ, if this</span>
<span class="sd">            keyword argument is passed, and `duration` is not, it will be used</span>
<span class="sd">            as the number of events. It is ignored when not using the DAQ.</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">att</span><span class="p">,</span> <span class="n">pp</span>

    <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">daq</span>

        <span class="c1">#daq.end_run()</span>
        <span class="c1">#daq.disconnect()</span>

    <span class="n">evts</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;events&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">evts</span> <span class="k">if</span> <span class="n">evts</span> <span class="k">else</span> <span class="mi">240</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="mi">3</span>
            <span class="k">if</span> <span class="n">evts</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;`events` parameter ignored when not using DAQ! Use `duration`!&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="n">record</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">transmissions</span><span class="p">:</span>
            <span class="n">att</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
                <span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">daq</span><span class="o">.</span><span class="n">begin</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">record</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sleep</span><span class="p">(</span><span class="n">duration</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">use_daq</span><span class="p">:</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">end_run</span><span class="p">()</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.autorun" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">autorun</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_length</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">runs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">inspire</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">daq_delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">picker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cam</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Automate runs.... With optional quotes</p>
<h4 id="mfx.beamline.autorun--parameters">Parameters</h4>
<p>sample: str, optional
    Sample Name</p>


<details class="tag" open>
  <summary>str, optional</summary>
  <p>Run group tag</p>
</details>

<details class="run_length" open>
  <summary>int, optional</summary>
  <p>number of seconds for run 300 is default</p>
</details>

<details class="record" open>
  <summary>bool, optional</summary>
  <p>set True to record</p>
</details>

<details class="runs" open>
  <summary>int, optional</summary>
  <p>number of runs 5 is default</p>
</details>

<details class="inspire" open>
  <summary>bool, optional</summary>
  <p>Set false by default because it makes Sandra sad. Set True to inspire</p>
</details>

<details class="daq_delay" open>
  <summary>int, optional</summary>
  <p>delay time between runs. Default is 5 second but increase is the DAQ is being slow.</p>
</details>

<details class="picker" open>
  <summary>str, optional</summary>
  <p>If 'open' it opens pp before run starts. If 'flip' it flipflops before run starts</p>
</details>        <h4 id="mfx.beamline.autorun--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/autorun.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">autorun</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_length</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">runs</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">inspire</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">daq_delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">picker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cam</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Automate runs.... With optional quotes</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sample: str, optional</span>
<span class="sd">        Sample Name</span>

<span class="sd">    tag: str, optional</span>
<span class="sd">        Run group tag</span>

<span class="sd">    run_length: int, optional</span>
<span class="sd">        number of seconds for run 300 is default</span>

<span class="sd">    record: bool, optional</span>
<span class="sd">        set True to record</span>

<span class="sd">    runs: int, optional</span>
<span class="sd">        number of runs 5 is default</span>

<span class="sd">    inspire: bool, optional</span>
<span class="sd">        Set false by default because it makes Sandra sad. Set True to inspire</span>

<span class="sd">    daq_delay: int, optional</span>
<span class="sd">        delay time between runs. Default is 5 second but increase is the DAQ is being slow.</span>

<span class="sd">    picker: str, optional</span>
<span class="sd">        If &#39;open&#39; it opens pp before run starts. If &#39;flip&#39; it flipflops before run starts</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">daq</span><span class="p">,</span> <span class="n">pp</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">sample</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;water&#39;</span> <span class="ow">or</span> <span class="n">sample</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span><span class="s1">&#39;h2o&#39;</span><span class="p">:</span>
        <span class="n">inspire</span><span class="o">=</span><span class="kc">True</span>
    <span class="k">if</span> <span class="n">picker</span><span class="o">==</span><span class="s1">&#39;open&#39;</span><span class="p">:</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">open</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">picker</span><span class="o">==</span><span class="s1">&#39;flip&#39;</span><span class="p">:</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">flipflop</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">sample</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">runs</span><span class="p">):</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Run Number </span><span class="si">{</span><span class="n">daq</span><span class="o">.</span><span class="n">run_number</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> Running </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="s2">......</span><span class="si">{</span><span class="n">quote</span><span class="p">()[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">run_number</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">run_number</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">status</span> <span class="o">=</span> <span class="n">begin</span><span class="p">(</span><span class="n">duration</span> <span class="o">=</span> <span class="n">run_length</span><span class="p">,</span> <span class="n">record</span> <span class="o">=</span> <span class="n">record</span><span class="p">,</span> <span class="n">wait</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">end_run</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cam</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ioc_cam_recorder</span><span class="p">(</span><span class="n">cam</span><span class="p">,</span> <span class="n">run_length</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">pp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">post</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">run_number</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">inspire</span><span class="p">,</span> <span class="s1">&#39;Run ended prematurely. Probably sample delivery problem&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;[*] Stopping Run and exiting???...&quot;</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Run ended prematurely. Probably sample delivery problem&#39;</span><span class="p">)</span>
            <span class="k">break</span>

        <span class="n">post</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">tag</span><span class="p">,</span> <span class="n">run_number</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">inspire</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sleep</span><span class="p">(</span><span class="n">daq_delay</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">pp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;[*] Stopping Run and exiting???...&quot;</span><span class="p">)</span>
            <span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
            <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Run ended prematurely. Probably sample delivery problem&#39;</span><span class="p">)</span>
                <span class="k">break</span>
    <span class="k">if</span> <span class="n">status</span><span class="p">:</span>
        <span class="n">pp</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">daq</span><span class="o">.</span><span class="n">end_run</span><span class="p">()</span>
        <span class="n">daq</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Finished with all runs thank you for choosing the MFX beamline!</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.begin" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">begin</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">end_run</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Start the daq and block until the daq has begun acquiring data.</p>
<p>Optionally block with <code>wait=True</code> until the daq has finished aquiring
data. If blocking, a <code>ctrl+c</code> will end the run and clean up.</p>
<p>If omitted, any argument that is shared with <code>configure</code>
will fall back to the configured value.</p>
<p>Internally, this calls <code>kickoff</code> and manages its <code>Status</code> object.</p>
<h4 id="mfx.beamline.begin--parameters">Parameters</h4>
<p>events: <code>int</code>, optional
    Number events to take in the daq.</p>


<details class="duration" open>
  <summary><code>int</code>, optional</summary>
  <p>Time to run the daq in seconds, if <code>events</code> was not provided.</p>
</details>

<details class="record" open>
  <summary><code>bool</code>, optional</summary>
  <p>If <code>True</code>, we'll configure the daq to record data before this
run.</p>
</details>

<details class="use_l3t" open>
  <summary><code>bool</code>, optional</summary>
  <p>If <code>True</code>, we'll run with the level 3 trigger. This means that
if we specified a number of events, we will wait for that many
"good" events as determined by the daq.</p>
</details>

<details class="controls" open>
  <summary><code>dict{name: device}</code> or <code>list[device...]</code>, optional</summary>
  <p>If provided, values from these will make it into the DAQ data
stream as variables. We will check <code>device.position</code> and
<code>device.value</code> for quantities to use and we will update these
values each time begin is called. To provide a list, all devices
must have a <code>name</code> attribute.</p>
</details>

<details class="wait" open>
  <summary><code>bool</code>, optional</summary>
  <p>If <code>True</code>, wait for the daq to finish aquiring data. A
<code>KeyboardInterrupt</code> (<code>ctrl+c</code>) during this wait will end the
run and clean up.</p>
</details>

<details class="end_run" open>
  <summary><code>bool</code>, optional</summary>
  <p>If <code>True</code>, we'll end the run after the daq has stopped.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>mfx/autorun.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">begin</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
          <span class="n">record</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">end_run</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Start the daq and block until the daq has begun acquiring data.</span>

<span class="sd">    Optionally block with ``wait=True`` until the daq has finished aquiring</span>
<span class="sd">    data. If blocking, a ``ctrl+c`` will end the run and clean up.</span>

<span class="sd">    If omitted, any argument that is shared with `configure`</span>
<span class="sd">    will fall back to the configured value.</span>

<span class="sd">    Internally, this calls `kickoff` and manages its ``Status`` object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    events: ``int``, optional</span>
<span class="sd">        Number events to take in the daq.</span>

<span class="sd">    duration: ``int``, optional</span>
<span class="sd">        Time to run the daq in seconds, if ``events`` was not provided.</span>

<span class="sd">    record: ``bool``, optional</span>
<span class="sd">        If ``True``, we&#39;ll configure the daq to record data before this</span>
<span class="sd">        run.</span>

<span class="sd">    use_l3t: ``bool``, optional</span>
<span class="sd">        If ``True``, we&#39;ll run with the level 3 trigger. This means that</span>
<span class="sd">        if we specified a number of events, we will wait for that many</span>
<span class="sd">        &quot;good&quot; events as determined by the daq.</span>

<span class="sd">    controls: ``dict{name: device}`` or ``list[device...]``, optional</span>
<span class="sd">        If provided, values from these will make it into the DAQ data</span>
<span class="sd">        stream as variables. We will check ``device.position`` and</span>
<span class="sd">        ``device.value`` for quantities to use and we will update these</span>
<span class="sd">        values each time begin is called. To provide a list, all devices</span>
<span class="sd">        must have a ``name`` attribute.</span>

<span class="sd">    wait: ``bool``, optional</span>
<span class="sd">        If ``True``, wait for the daq to finish aquiring data. A</span>
<span class="sd">        ``KeyboardInterrupt`` (``ctrl+c``) during this wait will end the</span>
<span class="sd">        run and clean up.</span>

<span class="sd">    end_run: ``bool``, optional</span>
<span class="sd">        If ``True``, we&#39;ll end the run after the daq has stopped.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">time</span><span class="w"> </span><span class="kn">import</span> <span class="n">sleep</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">daq</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">ophyd.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">StatusTimeoutError</span><span class="p">,</span> <span class="n">WaitTimeoutError</span>
    <span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">((</span><span class="s1">&#39;Daq.begin(events=</span><span class="si">%s</span><span class="s1">, duration=</span><span class="si">%s</span><span class="s1">, record=</span><span class="si">%s</span><span class="s1">, &#39;</span>
                    <span class="s1">&#39;use_l3t=</span><span class="si">%s</span><span class="s1">, controls=</span><span class="si">%s</span><span class="s1">, wait=</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">),</span>
                    <span class="n">events</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">record</span><span class="p">,</span> <span class="n">use_l3t</span><span class="p">,</span> <span class="n">controls</span><span class="p">,</span> <span class="n">wait</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">record</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">record</span> <span class="o">!=</span> <span class="n">daq</span><span class="o">.</span><span class="n">record</span><span class="p">:</span>
            <span class="n">old_record</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">record</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">preconfig</span><span class="p">(</span><span class="n">record</span><span class="o">=</span><span class="n">record</span><span class="p">,</span> <span class="n">show_queued_cfg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">begin_status</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">kickoff</span><span class="p">(</span><span class="n">events</span><span class="o">=</span><span class="n">events</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span>
                                    <span class="n">use_l3t</span><span class="o">=</span><span class="n">use_l3t</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="n">controls</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">begin_status</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">daq</span><span class="o">.</span><span class="n">_begin_timeout</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="n">StatusTimeoutError</span><span class="p">,</span> <span class="n">WaitTimeoutError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Timeout after </span><span class="si">{</span><span class="n">daq</span><span class="o">.</span><span class="n">_begin_timeout</span><span class="si">}</span><span class="s1"> seconds waiting &#39;</span>
                    <span class="s1">&#39;for daq to begin. Exception: {type(e).__name__}&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="c1">#raise DaqTimeoutError(msg) from None</span>

        <span class="c1"># In some daq configurations the begin status returns very early,</span>
        <span class="c1"># so we allow the user to configure an emperically derived extra</span>
        <span class="c1"># sleep.</span>
        <span class="n">sleep</span><span class="p">(</span><span class="n">daq</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;begin_sleep&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
            <span class="n">daq</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">end_run</span><span class="p">:</span>
                <span class="n">daq</span><span class="o">.</span><span class="n">end_run</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">end_run</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">wait</span><span class="p">:</span>
            <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">daq</span><span class="o">.</span><span class="n">_ender_thread</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">())</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">status</span>
    <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="n">status</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.correct_timing_drift" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">correct_timing_drift</span><span class="p">(</span><span class="n">amplitude_thresh</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">ipm_thresh</span><span class="o">=</span><span class="mf">500.0</span><span class="p">,</span> <span class="n">drift_adjustment_thresh</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">fwhm_threshs</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">130</span><span class="p">),</span> <span class="n">num_events</span><span class="o">=</span><span class="mi">61</span><span class="p">,</span> <span class="n">will_log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Automate the correction of timing drift. Will adjust the stages to
center the timetool edge on the camera and compensate the laser delay to
maintain the desired nominal time point. Runs in an infinite loop.</p>
<h4 id="mfx.beamline.correct_timing_drift--parameters">Parameters</h4>
<p>amplitude_thresh : float, optional
    The minimum amplitude of the fitted timetool peak to include the
    data point in the rolling average used for drift correction.
    Default: 0.02.
ipm_thresh : float, optional
    The minimum ipm DG2 value to perform drift correction. Setting a
    reasonable value prevents attempts at drift correction when X-rays
    are very weak or down. Default: 500.
drift_adjustment_thresh : float, optional
    The minimum drift value to correct for in picoseconds. E.g. a value
    of 0.05 means any time the rolling average finds that the timetool
    center is off by 50 fs in either direction it will compensate. Default:
    0.05 ps.
fwhm_threshs : Tuple[float, float], optional
    Minimum and maximum FWHM from the processed timetool signal to consider
    a measurement to be "good."
num_events : int, optional
    The number of "good" timetool edge measurements to include in the
    rolling average. Ideally a prime number to remove effects from
    sytematic errors. Default 61 measurements.
will_log : bool, optional
    Log timing corrections to a file.</p>

            <details class="quote">
              <summary>Source code in <code>mfx/timetool.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">correct_timing_drift</span><span class="p">(</span>
    <span class="n">amplitude_thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.02</span><span class="p">,</span>
    <span class="n">ipm_thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">500.0</span><span class="p">,</span>
    <span class="n">drift_adjustment_thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span>
    <span class="n">fwhm_threshs</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">130</span><span class="p">),</span>
    <span class="n">num_events</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">61</span><span class="p">,</span>
    <span class="n">will_log</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Automate the correction of timing drift. Will adjust the stages to</span>
<span class="sd">    center the timetool edge on the camera and compensate the laser delay to</span>
<span class="sd">    maintain the desired nominal time point. Runs in an infinite loop.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    amplitude_thresh : float, optional</span>
<span class="sd">        The minimum amplitude of the fitted timetool peak to include the</span>
<span class="sd">        data point in the rolling average used for drift correction.</span>
<span class="sd">        Default: 0.02.</span>
<span class="sd">    ipm_thresh : float, optional</span>
<span class="sd">        The minimum ipm DG2 value to perform drift correction. Setting a</span>
<span class="sd">        reasonable value prevents attempts at drift correction when X-rays</span>
<span class="sd">        are very weak or down. Default: 500.</span>
<span class="sd">    drift_adjustment_thresh : float, optional</span>
<span class="sd">        The minimum drift value to correct for in picoseconds. E.g. a value</span>
<span class="sd">        of 0.05 means any time the rolling average finds that the timetool</span>
<span class="sd">        center is off by 50 fs in either direction it will compensate. Default:</span>
<span class="sd">        0.05 ps.</span>
<span class="sd">    fwhm_threshs : Tuple[float, float], optional</span>
<span class="sd">        Minimum and maximum FWHM from the processed timetool signal to consider</span>
<span class="sd">        a measurement to be &quot;good.&quot;</span>
<span class="sd">    num_events : int, optional</span>
<span class="sd">        The number of &quot;good&quot; timetool edge measurements to include in the</span>
<span class="sd">        rolling average. Ideally a prime number to remove effects from</span>
<span class="sd">        sytematic errors. Default 61 measurements.</span>
<span class="sd">    will_log : bool, optional</span>
<span class="sd">        Log timing corrections to a file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">lxt</span><span class="p">,</span> <span class="n">txt</span>

    <span class="n">logfile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">will_log</span><span class="p">:</span>
        <span class="n">logfile</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;Please enter a file to log correction info to: &quot;</span><span class="p">)</span>

    <span class="n">timetool_edges</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="n">num_events</span><span class="p">])</span>

    <span class="n">write_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Entering timetool drift correction loop&quot;</span><span class="p">,</span> <span class="n">logfile</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">num_curr_edges</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">time_last_good_val</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">num_curr_edges</span> <span class="o">&lt;</span> <span class="n">num_events</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># EVENTBUILD PV contains 10 fields. TTALL makes up the last 8.</span>
                    <span class="c1"># (indices 0-7), and IPM DG1 and DG2 makeup the first 2.</span>
                    <span class="c1"># See `is_good_measurement` function for more accesses.</span>
                    <span class="n">timetool</span><span class="p">:</span> <span class="n">EpicsSignal</span> <span class="o">=</span> <span class="n">EpicsSignal</span><span class="p">(</span><span class="s2">&quot;MFX:TT:01:EVENTBUILD.VALA&quot;</span><span class="p">)</span>
                    <span class="n">tt_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">timetool</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>

                    <span class="n">timetool_edge_ps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">tt_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

                    <span class="k">if</span> <span class="n">is_good_measurement</span><span class="p">(</span>
                        <span class="n">tt_data</span><span class="p">,</span> <span class="n">amplitude_thresh</span><span class="p">,</span> <span class="n">ipm_thresh</span><span class="p">,</span> <span class="n">fwhm_threshs</span>
                    <span class="p">):</span>
                        <span class="n">timetool_edges</span><span class="p">[</span><span class="n">num_curr_edges</span><span class="p">]</span> <span class="o">=</span> <span class="n">timetool_edge_ps</span>
                        <span class="n">num_curr_edges</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">time_last_good_val</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                    <span class="k">elif</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">time_last_good_val</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>
                        <span class="n">write_log</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;No good measurement over one minute. Check thresholds?&quot;</span><span class="p">,</span>
                            <span class="n">logfile</span><span class="p">,</span>
                        <span class="p">)</span>
                        <span class="n">time_last_good_val</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

                    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">KeyboardInterrupt</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyboardInterrupt</span>

            <span class="n">tt_edge_average_ps</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">timetool_edges</span><span class="p">)</span>
            <span class="n">write_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Current average: </span><span class="si">{</span><span class="n">tt_edge_average_ps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">logfile</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tt_edge_average_ps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">drift_adjustment_thresh</span><span class="p">:</span>
                <span class="n">tt_average_seconds</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">tt_edge_average_ps</span> <span class="o">*</span> <span class="mf">1e-12</span><span class="p">)</span>
                <span class="n">write_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Making adjustment to </span><span class="si">{</span><span class="n">tt_average_seconds</span><span class="si">}</span><span class="s2">!&quot;</span><span class="p">,</span> <span class="n">logfile</span><span class="p">)</span>
                <span class="n">lxt</span><span class="o">.</span><span class="n">mvr</span><span class="p">(</span><span class="n">tt_average_seconds</span><span class="p">)</span>
                <span class="n">lxt</span><span class="o">.</span><span class="n">set_current_position</span><span class="p">(</span><span class="o">-</span><span class="nb">float</span><span class="p">(</span><span class="n">txt</span><span class="o">.</span><span class="n">position</span><span class="p">))</span>

        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">write_log</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Breaking out of timetool drift correction loop&quot;</span><span class="p">,</span> <span class="n">logfile</span><span class="p">)</span>
            <span class="k">break</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.delay_scan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delay_scan</span><span class="p">(</span><span class="n">daq</span><span class="p">,</span> <span class="n">time_motor</span><span class="p">,</span> <span class="n">time_points</span><span class="p">,</span> <span class="n">sweep_time</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Bluesky plan that sets up and executes the delay scan.</p>
<h4 id="mfx.beamline.delay_scan--parameters">Parameters</h4>
<p>daq: Daq
    The daq</p>


<details class="time_motor" open>
  <summary>DelayNewport</summary>
  <p>The movable device in seconds</p>
</details>

<details class="time_points" open>
  <summary>list of float</summary>
  <p>The times in second to move between</p>
</details>

<details class="sweep_time" open>
  <summary>float</summary>
  <p>The duration we take to move from one end of the range to the other.</p>
</details>

<details class="record" open>
  <summary>bool, optional</summary>
  <p>Whether or not to record in the daq</p>
</details>

<details class="duration" open>
  <summary>float, optional</summary>
  <p>If provided, the time to run in seconds. If omitted, we'll run forever.</p>
</details>

<details class="use_l3t" open>
  <summary>bool, optional</summary>
  <p>If True, events argument will be interpreted to only count events that
pass the level 3 trigger</p>
</details>

<details class="controls" open>
  <summary>dict or list of devices, optional</summary>
  <p>If provided, values will make it to DAQ data stream as variables</p>
</details>
            <details class="quote">
              <summary>Source code in <code>mfx/delay_scan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">delay_scan</span><span class="p">(</span><span class="n">daq</span><span class="p">,</span> <span class="n">time_motor</span><span class="p">,</span> <span class="n">time_points</span><span class="p">,</span> <span class="n">sweep_time</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
               <span class="n">record</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">controls</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bluesky plan that sets up and executes the delay scan.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    daq: Daq</span>
<span class="sd">        The daq</span>

<span class="sd">    time_motor: DelayNewport</span>
<span class="sd">        The movable device in seconds</span>

<span class="sd">    time_points: list of float</span>
<span class="sd">        The times in second to move between</span>

<span class="sd">    sweep_time: float</span>
<span class="sd">        The duration we take to move from one end of the range to the other.</span>

<span class="sd">    record: bool, optional</span>
<span class="sd">        Whether or not to record in the daq</span>

<span class="sd">    duration: float, optional</span>
<span class="sd">        If provided, the time to run in seconds. If omitted, we&#39;ll run forever.</span>

<span class="sd">    use_l3t: bool, optional</span>
<span class="sd">        If True, events argument will be interpreted to only count events that</span>
<span class="sd">        pass the level 3 trigger</span>

<span class="sd">    controls: dict or list of devices, optional</span>
<span class="sd">        If provided, values will make it to DAQ data stream as variables</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">spatial_pts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">time_pt</span> <span class="ow">in</span> <span class="n">time_points</span><span class="p">:</span>
        <span class="n">pseudo_tuple</span> <span class="o">=</span> <span class="n">time_motor</span><span class="o">.</span><span class="n">PseudoPosition</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="n">time_pt</span><span class="p">)</span>
        <span class="n">real_tuple</span> <span class="o">=</span> <span class="n">time_motor</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">pseudo_tuple</span><span class="p">)</span>
        <span class="n">spatial_pts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real_tuple</span><span class="o">.</span><span class="n">motor</span><span class="p">)</span>

    <span class="n">space_delta</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">spatial_pts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">spatial_pts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">velo</span> <span class="o">=</span> <span class="n">space_delta</span><span class="o">/</span><span class="n">sweep_time</span>

    <span class="k">yield from</span> <span class="n">bps</span><span class="o">.</span><span class="n">abs_set</span><span class="p">(</span><span class="n">time_motor</span><span class="o">.</span><span class="n">motor</span><span class="o">.</span><span class="n">velocity</span><span class="p">,</span> <span class="n">velo</span><span class="p">)</span>

    <span class="n">scan</span> <span class="o">=</span> <span class="n">infinite_scan</span><span class="p">([],</span> <span class="n">time_motor</span><span class="p">,</span> <span class="n">time_points</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="n">duration</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">daq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">daq_during_wrapper</span><span class="p">(</span><span class="n">scan</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">record</span><span class="p">,</span> <span class="n">use_l3t</span><span class="o">=</span><span class="n">use_l3t</span><span class="p">,</span>
                                      <span class="n">controls</span><span class="o">=</span><span class="n">controls</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">yield from</span> <span class="n">scan</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.detector_image" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">detector_image</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="s1">&#39;Rayonix&#39;</span><span class="p">,</span> <span class="n">calibdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ave</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Launches detector monitor</p>
<h4 id="mfx.beamline.detector_image--parameters">Parameters</h4>
<p>node: int, optional
    Node to run detector monitor 1-9 only</p>


<details class="det" open>
  <summary>str, optional</summary>
  <p>Detector name. Example 'Rayonix'</p>
</details>

<details class="calibdir" open>
  <summary>str, optional</summary>
  <p>path to calib directory</p>
</details>

<details class="ave" open>
  <summary>int, optional</summary>
  <p>Average over this number of events</p>
</details>        <h4 id="mfx.beamline.detector_image--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/detector_image.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">detector_image</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">det</span><span class="o">=</span><span class="s1">&#39;Rayonix&#39;</span><span class="p">,</span> <span class="n">calibdir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ave</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Launches detector monitor</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    node: int, optional</span>
<span class="sd">        Node to run detector monitor 1-9 only</span>

<span class="sd">    det: str, optional</span>
<span class="sd">        Detector name. Example &#39;Rayonix&#39;</span>

<span class="sd">    calibdir: str, optional</span>
<span class="sd">        path to calib directory</span>

<span class="sd">    ave: int, optional</span>
<span class="sd">        Average over this number of events</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.macros</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_exp</span>

    <span class="n">experiment</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">get_exp</span><span class="p">())</span>

    <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;ssh -YAC mfxopr@daq-mfx-mon0</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="sa">f</span><span class="s2">&quot;/cds/group/pcds/pyps/apps/hutch-python/mfx/scripts/&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;detector_image.sh </span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">det</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">calibdir</span><span class="p">)</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">ave</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">]</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

    <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
        <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.detector_image_kill" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">detector_image_kill</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Kills all detector monitors made with this script</p>
<h4 id="mfx.beamline.detector_image_kill--parameters">Parameters</h4>
<p>node: int, optional
    Node to run detector monitor 1-9 only</p>


<details class="det" open>
  <summary>str, optional</summary>
  <p>Detector name. Example 'Rayonix'</p>
</details>

<details class="calibdir" open>
  <summary>str, optional</summary>
  <p>path to calib directory</p>
</details>

<details class="ave" open>
  <summary>int, optional</summary>
  <p>Average over this number of events</p>
</details>        <h4 id="mfx.beamline.detector_image_kill--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/detector_image.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">detector_image_kill</span><span class="p">(</span><span class="n">node</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Kills all detector monitors made with this script</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    node: int, optional</span>
<span class="sd">        Node to run detector monitor 1-9 only</span>

<span class="sd">    det: str, optional</span>
<span class="sd">        Detector name. Example &#39;Rayonix&#39;</span>

<span class="sd">    calibdir: str, optional</span>
<span class="sd">        path to calib directory</span>

<span class="sd">    ave: int, optional</span>
<span class="sd">        Average over this number of events</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>

    <span class="n">proc</span> <span class="o">=</span> <span class="p">[</span>
        <span class="sa">f</span><span class="s2">&quot;ssh -YAC mfxopr@daq-mfx-mon0</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span> <span class="o">+</span>
        <span class="sa">f</span><span class="s2">&quot;/cds/group/pcds/pyps/apps/hutch-python/mfx/scripts/&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;detector_image_kill.sh&quot;</span>
        <span class="p">]</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">proc</span><span class="p">)</span>

    <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
        <span class="n">proc</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.focus_scan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">focus_scan</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">299</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Runs through transfocator Z to find the best focus</p>
<h4 id="mfx.beamline.focus_scan--parameters">Parameters</h4>
<p>camera: str, required
    camera where you want to focus</p>


<details class="step" open>
  <summary>int, optional</summary>
  <p>step size of transfocator movements</p>
</details>

<details class="start" open>
  <summary>int, optional</summary>
  <p>starting transfocator position</p>
</details>

<details class="end" open>
  <summary>int, optional</summary>
  <p>final transfocator position</p>
</details>        <p>Examples:
mfx dg1 yag is MFX:DG1:P6740
mfx dg2 yag is MFX:DG2:P6740
mfx dg3 yag is MFX:GIGE:02:IMAGE1</p>
<h4 id="mfx.beamline.focus_scan--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/focus_scan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">focus_scan</span><span class="p">(</span><span class="n">camera</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">299</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs through transfocator Z to find the best focus</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    camera: str, required</span>
<span class="sd">        camera where you want to focus</span>

<span class="sd">    step: int, optional</span>
<span class="sd">	step size of transfocator movements</span>

<span class="sd">    start: int, optional</span>
<span class="sd">	starting transfocator position</span>

<span class="sd">    end: int, optional</span>
<span class="sd">	final transfocator position</span>

<span class="sd">    Examples:</span>
<span class="sd">    mfx dg1 yag is MFX:DG1:P6740</span>
<span class="sd">    mfx dg2 yag is MFX:DG2:P6740</span>
<span class="sd">    mfx dg3 yag is MFX:GIGE:02:IMAGE1</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># cd /reg/g/pcds/pyps/apps/hutch-python/mfx/mfx</span>
    <span class="c1"># from mfx.transfocator_scan import *</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.transfocator_scan</span><span class="w"> </span><span class="kn">import</span> <span class="n">transfocator_aligner</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">tfs</span>

    <span class="n">trf_align</span> <span class="o">=</span> <span class="n">transfocator_aligner</span><span class="p">(</span><span class="n">camera</span><span class="p">)</span>
    <span class="n">trf_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
    <span class="n">trf_align</span><span class="o">.</span><span class="n">scan_transfocator</span><span class="p">(</span><span class="n">tfs</span><span class="o">.</span><span class="n">translation</span><span class="p">,</span><span class="n">trf_pos</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.infinite_scan" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">infinite_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">per_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">md</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Bluesky plan that moves a motor among points until interrupted.</p>
<h4 id="mfx.beamline.infinite_scan--parameters">Parameters</h4>
<p>detectors: list of readables
    Objects to read into Python in the scan.</p>


<details class="motor" open>
  <summary>settable</summary>
  <p>Object to move in the scan.</p>
</details>

<details class="points" open>
  <summary>list of floats</summary>
  <p>Positions to move between in the scan.</p>
</details>

<details class="duration" open>
  <summary>float</summary>
  <p>If provided, the time to run in seconds. If omitted, we'll run forever.</p>
</details>
            <details class="quote">
              <summary>Source code in <code>mfx/delay_scan.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">infinite_scan</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">motor</span><span class="p">,</span> <span class="n">points</span><span class="p">,</span> <span class="n">duration</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">per_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">md</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Bluesky plan that moves a motor among points until interrupted.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    detectors: list of readables</span>
<span class="sd">        Objects to read into Python in the scan.</span>

<span class="sd">    motor: settable</span>
<span class="sd">        Object to move in the scan.</span>

<span class="sd">    points: list of floats</span>
<span class="sd">        Positions to move between in the scan.</span>

<span class="sd">    duration: float</span>
<span class="sd">        If provided, the time to run in seconds. If omitted, we&#39;ll run forever.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">per_step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">per_step</span> <span class="o">=</span> <span class="n">bps</span><span class="o">.</span><span class="n">one_nd_step</span>

    <span class="k">if</span> <span class="n">md</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">md</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">md</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">motors</span><span class="o">=</span><span class="p">[</span><span class="n">motor</span><span class="o">.</span><span class="n">name</span><span class="p">])</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1">#@bpp.stage_decorator(list(detectors) + [motor])</span>
    <span class="nd">@bpp</span><span class="o">.</span><span class="n">reset_positions_decorator</span><span class="p">()</span>
    <span class="nd">@bpp</span><span class="o">.</span><span class="n">run_decorator</span><span class="p">(</span><span class="n">md</span><span class="o">=</span><span class="n">md</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">inner</span><span class="p">():</span>
        <span class="c1"># Where last position is stored</span>
        <span class="n">pos_cache</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">duration</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="n">duration</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pt</span> <span class="ow">in</span> <span class="n">points</span><span class="p">:</span>
                <span class="n">step</span> <span class="o">=</span> <span class="p">{</span><span class="n">motor</span><span class="p">:</span> <span class="n">pt</span><span class="p">}</span>
                <span class="k">yield from</span> <span class="n">per_step</span><span class="p">(</span><span class="n">detectors</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">pos_cache</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="k">yield from</span> <span class="n">inner</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.ioc_cam_recorder" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ioc_cam_recorder</span><span class="p">(</span><span class="n">cam</span><span class="o">=</span><span class="s1">&#39;camera name&#39;</span><span class="p">,</span> <span class="n">run_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Record IOC Cameras</p>
<h4 id="mfx.beamline.ioc_cam_recorder--parameters">Parameters</h4>
<p>cam: str, required
    Select camera PV you'd like to record</p>


<details class="run_length" open>
  <summary>int, required</summary>
  <p>number of seconds for recording. 10 is default</p>
</details>

<details class="tag" open>
  <summary>str, required</summary>
  <p>Run group tag</p>
</details>        <h4 id="mfx.beamline.ioc_cam_recorder--operations">Operations</h4>

            <details class="quote">
              <summary>Source code in <code>mfx/autorun.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ioc_cam_recorder</span><span class="p">(</span><span class="n">cam</span><span class="o">=</span><span class="s1">&#39;camera name&#39;</span><span class="p">,</span> <span class="n">run_length</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Record IOC Cameras</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    cam: str, required</span>
<span class="sd">        Select camera PV you&#39;d like to record</span>

<span class="sd">    run_length: int, required</span>
<span class="sd">        number of seconds for recording. 10 is default</span>

<span class="sd">    tag: str, required</span>
<span class="sd">        Run group tag</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">epics</span><span class="w"> </span><span class="kn">import</span> <span class="n">caget</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.bash_utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">bs</span>
    <span class="n">bs</span> <span class="o">=</span> <span class="n">bs</span><span class="p">()</span>
    <span class="n">camera_names</span> <span class="o">=</span> <span class="n">bs</span><span class="o">.</span><span class="n">camera_list_out</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">cam</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">pv</span> <span class="ow">in</span> <span class="n">camera_names</span><span class="p">]:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Desired Camera not in List. Please choose from the above list:.&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rate</span> <span class="o">=</span> <span class="n">caget</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">cam</span><span class="si">}</span><span class="s1">:ArrayRate_RBV&#39;</span><span class="p">)</span>
        <span class="n">n_images</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">run_length</span> <span class="o">*</span> <span class="n">rate</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Recording Camera </span><span class="si">{</span><span class="n">cam</span><span class="si">}</span><span class="s2"> for </span><span class="si">{</span><span class="n">run_length</span><span class="si">}</span><span class="s2"> sec&quot;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;/reg/g/pcds/engineering_tools/latest-released/scripts/image_saver -c </span><span class="si">{</span><span class="n">cam</span><span class="si">}</span><span class="s2"> -n </span><span class="si">{</span><span class="n">n_images</span><span class="si">}</span><span class="s2"> -f </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> -p /cds/data/iocData&quot;</span><span class="p">)</span>

        <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
            <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;source /cds/group/pcds/pyps/conda/pcds_conda; /reg/g/pcds/engineering_tools/latest-released/scripts/image_saver -c </span><span class="si">{</span><span class="n">cam</span><span class="si">}</span><span class="s2"> -n </span><span class="si">{</span><span class="n">n_images</span><span class="si">}</span><span class="s2"> -f </span><span class="si">{</span><span class="n">tag</span><span class="si">}</span><span class="s2"> -p /cds/data/iocData&quot;</span><span class="p">],</span>
            <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.laser_in" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">laser_in</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Insert the Reference Laser and clear the beampath</p>
<h4 id="mfx.beamline.laser_in--parameters">Parameters</h4>
<p>wait: bool, optional
    Wait and check that motion is properly completed</p>


<details class="timeout" open>
  <summary>float, optional</summary>
  <p>Time to wait for motion completion if requested to do so</p>
</details>        <h4 id="mfx.beamline.laser_in--operations">Operations</h4>
<ul>
<li>Insert the Reference Laser</li>
<li>Set the Wave8 out (35 mm)</li>
<li>Set the DG1 slits to 6 mm x 6 mm</li>
<li>Set the DG2 upstream slits to 6 mm x 6 mm</li>
<li>Set the DG2 midstream slits to 1 mm x 1 mm</li>
<li>Set the DG2 downstream slits to 1 mm x 1 mm</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>mfx/macros.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">laser_in</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Insert the Reference Laser and clear the beampath</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wait: bool, optional</span>
<span class="sd">        Wait and check that motion is properly completed</span>

<span class="sd">    timeout: float, optional</span>
<span class="sd">        Time to wait for motion completion if requested to do so</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>
<span class="sd">    * Insert the Reference Laser</span>
<span class="sd">    * Set the Wave8 out (35 mm)</span>
<span class="sd">    * Set the DG1 slits to 6 mm x 6 mm</span>
<span class="sd">    * Set the DG2 upstream slits to 6 mm x 6 mm</span>
<span class="sd">    * Set the DG2 midstream slits to 1 mm x 1 mm</span>
<span class="sd">    * Set the DG2 downstream slits to 1 mm x 1 mm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Command motion and collect status objects</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">mfx_reflaser</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">tfs</span> <span class="o">=</span> <span class="n">mfx_tfs</span><span class="o">.</span><span class="n">remove_all</span><span class="p">()</span>
    <span class="n">dg1_ipm</span><span class="o">=</span><span class="n">mfx_dg1_ipm</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">dg2_ipm</span><span class="o">=</span><span class="n">mfx_dg2_ipm</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">dg1</span> <span class="o">=</span> <span class="n">mfx_dg1_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_us</span> <span class="o">=</span> <span class="n">mfx_dg2_upstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">6.</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_ms</span> <span class="o">=</span> <span class="n">mfx_dg2_midstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#    dg2_ds = mfx_dg2_downstream_slits.move(1., wait=False)</span>
    <span class="c1"># Combine status and wait for completion</span>
    <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
        <span class="n">status_wait</span><span class="p">(</span><span class="n">ref</span> <span class="o">&amp;</span> <span class="n">dg1</span> <span class="o">&amp;</span> <span class="n">dg2_us</span> <span class="o">&amp;</span> <span class="n">dg2_ms</span><span class="p">,</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.laser_out" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">laser_out</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Remove the Reference Laser and configure the beamline</p>
<h4 id="mfx.beamline.laser_out--parameters">Parameters</h4>
<p>wait: bool, optional
    Wait and check that motion is properly completed</p>


<details class="timeout" open>
  <summary>float, optional</summary>
  <p>Time to wait for motion completion if requested to do so</p>
</details>        <h4 id="mfx.beamline.laser_out--operations">Operations</h4>
<ul>
<li>Remove the Reference Laser</li>
<li>Set the Wave8 Target 3 In (5.5 mm)</li>
<li>Set the DG1 slits to 0.7 mm x 0.7 mm</li>
<li>Set the DG2 upstream slits to 0.7 mm x 0.7 mm</li>
<li>Set the DG2 midstream slits to 0.7 mm x 0.7 mm</li>
<li>Set the DG2 downstream slits to 0.7 mm x 0.7 mm</li>
</ul>

            <details class="quote">
              <summary>Source code in <code>mfx/macros.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">laser_out</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Remove the Reference Laser and configure the beamline</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    wait: bool, optional</span>
<span class="sd">        Wait and check that motion is properly completed</span>

<span class="sd">    timeout: float, optional</span>
<span class="sd">        Time to wait for motion completion if requested to do so</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>
<span class="sd">    * Remove the Reference Laser</span>
<span class="sd">    * Set the Wave8 Target 3 In (5.5 mm)</span>
<span class="sd">    * Set the DG1 slits to 0.7 mm x 0.7 mm</span>
<span class="sd">    * Set the DG2 upstream slits to 0.7 mm x 0.7 mm</span>
<span class="sd">    * Set the DG2 midstream slits to 0.7 mm x 0.7 mm</span>
<span class="sd">    * Set the DG2 downstream slits to 0.7 mm x 0.7 mm</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Command motion and collect status objects</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">mfx_reflaser</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># Removing dg1 wave8 movement for now, until wave8 target positions have been fixed</span>
<span class="c1">#    w8 = mfx_dg1_wave8_motor.move(5.5, wait=False)</span>
    <span class="n">dg1</span> <span class="o">=</span> <span class="n">mfx_dg1_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_us</span> <span class="o">=</span> <span class="n">mfx_dg2_upstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_ms</span> <span class="o">=</span> <span class="n">mfx_dg2_midstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#    dg2_ds = mfx_dg2_downstream_slits.move(0.7, wait=False)</span>
    <span class="c1"># Combine status and wait for completion</span>
    <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
        <span class="n">status_wait</span><span class="p">(</span><span class="n">ref</span> <span class="o">&amp;</span> <span class="n">w8</span> <span class="o">&amp;</span> <span class="n">dg1</span> <span class="o">&amp;</span> <span class="n">dg2_us</span> <span class="o">&amp;</span> <span class="n">dg2_ms</span> <span class="p">,</span>
                    <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.mfxslits" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">mfxslits</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Set all the slits to specific position</p>

            <details class="quote">
              <summary>Source code in <code>mfx/macros.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">mfxslits</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set all the slits to specific position&quot;&quot;&quot;</span>
    <span class="n">dg1</span> <span class="o">=</span> <span class="n">mfx_dg1_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_us</span> <span class="o">=</span> <span class="n">mfx_dg2_upstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_ms</span> <span class="o">=</span> <span class="n">mfx_dg2_midstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">dg2_ds</span> <span class="o">=</span> <span class="n">mfx_dg2_downstream_slits</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">pos</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.post" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">post</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inspire</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_note</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Posts a message to the elog</p>
<h4 id="mfx.beamline.post--parameters">Parameters</h4>
<p>sample: str, optional
    Sample Name</p>


<details class="run_number" open>
  <summary>int, optional</summary>
  <p>Run Number. By default this is read off of the DAQ</p>
</details>

<details class="post" open>
  <summary>bool, optional</summary>
  <p>set True to record/post message to elog</p>
</details>

<details class="inspire" open>
  <summary>bool, optional</summary>
  <p>Set false by default because it makes Sandra sad. Set True to inspire</p>
</details>

<details class="add_note" open>
  <summary>string, optional</summary>
  <p>adds additional note to elog message</p>
</details>
            <details class="quote">
              <summary>Source code in <code>mfx/autorun.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">post</span><span class="p">(</span><span class="n">sample</span><span class="o">=</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_number</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">post</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inspire</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">add_note</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Posts a message to the elog</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    sample: str, optional</span>
<span class="sd">        Sample Name</span>

<span class="sd">    run_number: int, optional</span>
<span class="sd">        Run Number. By default this is read off of the DAQ</span>

<span class="sd">    post: bool, optional</span>
<span class="sd">        set True to record/post message to elog</span>

<span class="sd">    inspire: bool, optional</span>
<span class="sd">        Set false by default because it makes Sandra sad. Set True to inspire</span>

<span class="sd">    add_note: string, optional</span>
<span class="sd">        adds additional note to elog message </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">mfx.db</span><span class="w"> </span><span class="kn">import</span> <span class="n">daq</span><span class="p">,</span> <span class="n">elog</span>
    <span class="k">if</span> <span class="n">add_note</span><span class="o">!=</span><span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">add_note</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">add_note</span>
    <span class="k">if</span> <span class="n">tag</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">tag</span> <span class="o">=</span> <span class="n">sample</span>
    <span class="k">if</span> <span class="n">inspire</span><span class="p">:</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="n">sample</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">quote</span><span class="p">()[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span><span class="si">}{</span><span class="n">add_note</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Running </span><span class="si">{</span><span class="n">sample</span><span class="si">}{</span><span class="n">add_note</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">if</span> <span class="n">run_number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">run_number</span> <span class="o">=</span> <span class="n">daq</span><span class="o">.</span><span class="n">run_number</span><span class="p">()</span>
    <span class="n">info</span> <span class="o">=</span> <span class="p">[</span><span class="n">run_number</span><span class="p">,</span> <span class="n">comment</span><span class="p">]</span>
    <span class="n">post_msg</span> <span class="o">=</span> <span class="n">post_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">info</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">post_msg</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">post</span><span class="p">:</span>
        <span class="n">elog</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">msg</span><span class="o">=</span><span class="n">post_msg</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tag</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="p">(</span><span class="n">run_number</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">post_msg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="mfx.beamline.xlj_fast_xyz" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">xlj_fast_xyz</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <h4 id="mfx.beamline.xlj_fast_xyz--parameters">Parameters</h4>
<p>orientation: str, optional
    set orientation to change the x and y axis. horizontal by default
    use only 'horizontal' of 'vertical'</p>


<details class="scale" open>
  <summary>float, optional</summary>
  <p>starting scale for the step size</p>
</details>        <h4 id="mfx.beamline.xlj_fast_xyz--operations">Operations</h4>
<p>Base function to control motors with the arrow keys.</p>
<p>With three motors, you can use the right and left arrow keys to move right 
and left, up and down arrow keys to move up and down, and Shift+up and 
shift+down to move z in and out</p>
<p>The scale for the tweak can be doubled by pressing + and halved by pressing
-. Shift+right and shift+left can also be used, and the up and down keys will
also adjust the scaling in one motor mode. The starting scale can be set
with the keyword argument <code>scale</code>.</p>
<p>Ctrl+c will stop an ongoing move during a tweak without exiting the tweak.
Both q and ctrl+c will quit the tweak between moves.</p>

            <details class="quote">
              <summary>Source code in <code>mfx/xlj_fast.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">xlj_fast_xyz</span><span class="p">(</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    orientation: str, optional</span>
<span class="sd">        set orientation to change the x and y axis. horizontal by default</span>
<span class="sd">        use only &#39;horizontal&#39; of &#39;vertical&#39;</span>

<span class="sd">    scale: float, optional</span>
<span class="sd">        starting scale for the step size</span>

<span class="sd">    Operations</span>
<span class="sd">    ----------</span>
<span class="sd">    Base function to control motors with the arrow keys.</span>

<span class="sd">    With three motors, you can use the right and left arrow keys to move right </span>
<span class="sd">    and left, up and down arrow keys to move up and down, and Shift+up and </span>
<span class="sd">    shift+down to move z in and out</span>

<span class="sd">    The scale for the tweak can be doubled by pressing + and halved by pressing</span>
<span class="sd">    -. Shift+right and shift+left can also be used, and the up and down keys will</span>
<span class="sd">    also adjust the scaling in one motor mode. The starting scale can be set</span>
<span class="sd">    with the keyword argument `scale`.</span>

<span class="sd">    Ctrl+c will stop an ongoing move during a tweak without exiting the tweak.</span>
<span class="sd">    Both q and ctrl+c will quit the tweak between moves.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">xlj_fast_x</span> <span class="o">=</span> <span class="n">BypassPositionCheck</span><span class="p">(</span><span class="s2">&quot;MFX:LJH:JET:X&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;xlj_fast_x&quot;</span><span class="p">)</span>
        <span class="n">xlj_fast_y</span> <span class="o">=</span> <span class="n">BypassPositionCheck</span><span class="p">(</span><span class="s2">&quot;MFX:LJH:JET:Y&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;xlj_fast_y&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">xlj_fast_y</span> <span class="o">=</span> <span class="n">BypassPositionCheck</span><span class="p">(</span><span class="s2">&quot;MFX:LJH:JET:X&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;xlj_fast_x&quot;</span><span class="p">)</span>
        <span class="n">xlj_fast_x</span> <span class="o">=</span> <span class="n">BypassPositionCheck</span><span class="p">(</span><span class="s2">&quot;MFX:LJH:JET:Y&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;xlj_fast_y&quot;</span><span class="p">)</span>

    <span class="n">xlj_fast_z</span> <span class="o">=</span> <span class="n">BypassPositionCheck</span><span class="p">(</span><span class="s2">&quot;MFX:LJH:JET:Z&quot;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;xlj_fast_z&quot;</span><span class="p">)</span>

    <span class="n">xlj</span> <span class="o">=</span> <span class="n">BeckhoffJet</span><span class="p">(</span><span class="s1">&#39;MFX:LJH&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;xlj&#39;</span><span class="p">)</span>

    <span class="n">up</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[A&quot;</span>
    <span class="n">down</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[B&quot;</span>
    <span class="n">right</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[C&quot;</span>
    <span class="n">left</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[D&quot;</span>
    <span class="n">shift_up</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;2A&quot;</span>
    <span class="n">shift_down</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;2B&quot;</span>
    <span class="n">shift_right</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;2C&quot;</span>
    <span class="n">shift_left</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;2D&quot;</span>
    <span class="n">alt_up</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;3A&quot;</span>
    <span class="n">alt_down</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;3B&quot;</span>
    <span class="n">alt_right</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;3C&quot;</span>
    <span class="n">alt_left</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;3D&quot;</span>
    <span class="n">ctrl_up</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;5A&quot;</span>
    <span class="n">ctrl_down</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;5B&quot;</span>
    <span class="n">ctrl_right</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;5C&quot;</span>
    <span class="n">ctrl_left</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\x1b</span><span class="s2">[1;5D&quot;</span>
    <span class="n">plus</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span>
    <span class="n">equal</span> <span class="o">=</span> <span class="s2">&quot;=&quot;</span>
    <span class="n">minus</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
    <span class="n">under</span> <span class="o">=</span> <span class="s2">&quot;_&quot;</span>

    <span class="n">abs_status</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.4f}</span><span class="s1">&#39;</span>
    <span class="n">exp_status</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{:.4e}</span><span class="s1">&#39;</span>

    <span class="n">move_keys</span> <span class="o">=</span> <span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">down</span><span class="p">,</span> <span class="n">shift_up</span><span class="p">,</span> <span class="n">shift_down</span><span class="p">)</span>
    <span class="n">scale_keys</span> <span class="o">=</span> <span class="p">(</span><span class="n">plus</span><span class="p">,</span> <span class="n">minus</span><span class="p">,</span> <span class="n">equal</span><span class="p">,</span> <span class="n">under</span><span class="p">,</span> <span class="n">shift_right</span><span class="p">,</span> <span class="n">shift_left</span><span class="p">)</span>
    <span class="n">motors</span> <span class="o">=</span> <span class="p">[</span><span class="n">xlj_fast_x</span><span class="p">,</span> <span class="n">xlj_fast_y</span><span class="p">,</span> <span class="n">xlj_fast_z</span><span class="p">]</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">show_status</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">&gt;=</span> <span class="mf">0.0001</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">abs_status</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">template</span> <span class="o">=</span> <span class="n">exp_status</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">[</span><span class="n">template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mot</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">mot</span><span class="o">.</span><span class="n">wm</span><span class="p">())</span> <span class="k">for</span> <span class="n">mot</span> <span class="ow">in</span> <span class="n">motors</span><span class="p">]</span>
        <span class="n">text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;scale: </span><span class="si">{</span><span class="n">scale</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\x1b</span><span class="s1">[2K</span><span class="se">\r</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">text</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">usage</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Newline</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Left: move x motor left&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Right: move x motor right&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Down: move y motor down&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Up: move y motor up&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; shift+up: Z upstream&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; shift+down: Z downstream&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; + or shift+right: scale*2&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; - or shift+left: scale/2&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Press q to quit.&quot;</span>
              <span class="s2">&quot; Press any other key to display this message.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">()</span>  <span class="c1"># Newline</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">edit_scale</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function used to change the scale.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">(</span><span class="n">up</span><span class="p">,</span> <span class="n">shift_right</span><span class="p">,</span> <span class="n">plus</span><span class="p">,</span> <span class="n">equal</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">*</span><span class="mi">2</span>
        <span class="k">elif</span> <span class="n">direction</span> <span class="ow">in</span> <span class="p">(</span><span class="n">down</span><span class="p">,</span> <span class="n">shift_left</span><span class="p">,</span> <span class="n">minus</span><span class="p">,</span> <span class="n">under</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">scale</span>


    <span class="k">def</span><span class="w"> </span><span class="nf">movement</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Function used to know when and the direction to move the motor.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">left</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj_fast_x</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xlj.jet.x = </span><span class="si">{</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="si">}</span><span class="s1">, xlj_fast_x = </span><span class="si">{</span><span class="n">xlj_fast_x</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">xlj_fast_x</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">x</span><span class="p">())</span>
                <span class="n">xlj_fast_x</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">right</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">x</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj_fast_x</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xlj.jet.x = </span><span class="si">{</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">x</span><span class="p">()</span><span class="si">}</span><span class="s1">, xlj_fast_x = </span><span class="si">{</span><span class="n">xlj_fast_x</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">xlj_fast_x</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">x</span><span class="p">())</span>
                <span class="n">xlj_fast_x</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">up</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj_fast_y</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xlj.jet.y = </span><span class="si">{</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="si">}</span><span class="s1">, xlj_fast_y = </span><span class="si">{</span><span class="n">xlj_fast_y</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">xlj_fast_y</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
                <span class="n">xlj_fast_y</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">down</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">y</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj_fast_y</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xlj.jet.y = </span><span class="si">{</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">y</span><span class="p">()</span><span class="si">}</span><span class="s1">, xlj_fast_y = </span><span class="si">{</span><span class="n">xlj_fast_y</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">xlj_fast_y</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">y</span><span class="p">())</span>
                <span class="n">xlj_fast_y</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">shift_up</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj_fast_z</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xlj.jet.z = </span><span class="si">{</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">z</span><span class="p">()</span><span class="si">}</span><span class="s1">, xlj_fast_z = </span><span class="si">{</span><span class="n">xlj_fast_z</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">xlj_fast_z</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">z</span><span class="p">())</span>
                <span class="n">xlj_fast_z</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="o">-</span><span class="n">scale</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">direction</span> <span class="o">==</span> <span class="n">shift_down</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">z</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">round</span><span class="p">(</span><span class="n">xlj_fast_z</span><span class="p">(),</span> <span class="mi">2</span><span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;xlj.jet.z = </span><span class="si">{</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">z</span><span class="p">()</span><span class="si">}</span><span class="s1">, xlj_fast_z = </span><span class="si">{</span><span class="n">xlj_fast_z</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">xlj_fast_z</span><span class="o">.</span><span class="n">umv</span><span class="p">(</span><span class="n">xlj</span><span class="o">.</span><span class="n">jet</span><span class="o">.</span><span class="n">z</span><span class="p">())</span>
                <span class="n">xlj_fast_z</span><span class="o">.</span><span class="n">umvr</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Error in tweak move: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">start_text</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mot</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> at </span><span class="si">{</span><span class="n">mot</span><span class="o">.</span><span class="n">wm</span><span class="p">()</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">mot</span> <span class="ow">in</span> <span class="n">motors</span><span class="p">]</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Started tweak of &#39;</span> <span class="o">+</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">start_text</span><span class="p">))</span>
    <span class="n">usage</span><span class="p">()</span>

    <span class="c1"># Loop takes in user key input and stops when &#39;q&#39; is pressed</span>
    <span class="n">is_input</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">while</span> <span class="n">is_input</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">show_status</span><span class="p">()</span>
        <span class="n">inp</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">get_input</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">inp</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;q&#39;</span><span class="p">):</span>
            <span class="n">is_input</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">move_keys</span><span class="p">:</span>
            <span class="n">movement</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">inp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">inp</span> <span class="ow">in</span> <span class="n">scale_keys</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">edit_scale</span><span class="p">(</span><span class="n">scale</span><span class="p">,</span> <span class="n">inp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">inp</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">):</span>
            <span class="n">usage</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Not the way to use this. Press &quot;h&quot; to see how.&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Tweak complete&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      © 2025 LCLS
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>